# NeuroNova CDSS - ë°ì´í„° íë¦„ ì•„í‚¤í…ì²˜

**ì‘ì„±ì¼**: 2025-12-30
**ë²„ì „**: v1.0

---

## ğŸ“Š ë°ì´í„° ì €ì¥ì†Œ êµ¬ì¡°

NeuroNova CDSSëŠ” ë°ì´í„° ì¢…ë¥˜ì— ë”°ë¼ 3ê°œì˜ ì €ì¥ì†Œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     NeuroNova CDSS                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Django MySQL    â”‚  OpenEMR MySQL  â”‚  HAPI FHIR  â”‚ Orthanc â”‚
â”‚  (Cache/Fast)    â”‚  (EMR Detail)   â”‚  (Exchange) â”‚ (DICOM) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1. Django MySQL (ê³ ì† ìºì‹œ + ì¼ë¶€ ìƒì„¸ ë°ì´í„°)

**ìš©ë„**: ë¹ ë¥¸ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ ë° ê²€ìƒ‰, ì¼ë¶€ ë„ë©”ì¸ì˜ ì™„ì „í•œ ë°ì´í„° ì €ì¥

**ì €ì¥ ë°ì´í„°**:
- **EMR ê¸°ë³¸ ì •ë³´** (ìºì‹œìš©):
  - `PatientCache`: í™˜ì ê¸°ë³¸ ì •ë³´ (ì´ë¦„, ìƒë…„ì›”ì¼, ì„±ë³„, ì—°ë½ì²˜)
  - `Encounter`: ì§„ë£Œ ê¸°ë¡ ê¸°ë³¸ ì •ë³´
  - `Order`: ì²˜ë°© ì£¼ë¬¸ ê¸°ë³¸ ì •ë³´

- **LIS ì™„ì „ ë°ì´í„°** (ìºì‹œ ì•„ë‹˜, ì‹¤ì œ ì €ì¥ì†Œ):
  - `LabTestMaster`: ê²€ì‚¬ ë§ˆìŠ¤í„° ë°ì´í„°
  - `LabResult`: ê²€ì‚¬ ê²°ê³¼ ì „ì²´ (ìœ ì „ ì •ë³´ í¬í•¨)

- **AI ì¶”ë¡  ê²°ê³¼** (í…ìŠ¤íŠ¸/ìˆ«ìí˜•):
  - `AIJob`: AI ë¶„ì„ ì‘ì—… ë° ê²°ê³¼
  - `result_data` (JSONField): í…ìŠ¤íŠ¸, 2ì§„, intí˜• ì¶”ë¡  ê²°ê³¼

- **RIS ë©”íƒ€ë°ì´í„°**:
  - `RadiologyStudy`: DICOM ë©”íƒ€ë°ì´í„° (Orthanc ë™ê¸°í™”)
  - `RadiologyReport`: íŒë…ë¬¸

**í…Œì´ë¸” ìš”ì•½**:
```
emr_patient_cache         -- í™˜ì ê¸°ë³¸ ì •ë³´ (ìºì‹œ)
emr_encounters            -- ì§„ë£Œ ê¸°ë¡ (ìºì‹œ)
ocs_orders                -- ì²˜ë°© ì£¼ë¬¸ (ìºì‹œ)
lis_lab_results           -- ê²€ì‚¬ ê²°ê³¼ (ì™„ì „ ë°ì´í„°, ìœ ì „ ì •ë³´ í¬í•¨)
ai_aijob                  -- AI ì¶”ë¡  ì‘ì—…/ê²°ê³¼ (í…ìŠ¤íŠ¸/ìˆ«ì)
ris_radiology_study       -- ì˜ìƒ ë©”íƒ€ë°ì´í„°
```

---

### 2. OpenEMR MySQL (EMR ìƒì„¸ ë°ì´í„°)

**ìš©ë„**: í‘œì¤€ EMR ê¸°ëŠ¥, ì§„ë£Œ ê¸°ë¡ ìƒì„¸ ì •ë³´

**ì €ì¥ ë°ì´í„°**:
- í™˜ì ìƒì„¸ ì •ë³´ (ê³¼ê±° ë³‘ë ¥, ê°€ì¡±ë ¥, ì‚¬íšŒë ¥ ë“±)
- ì§„ë£Œ ê¸°ë¡ ìƒì„¸ (ì£¼ê´€ì  ì†Œê²¬, ê°ê´€ì  ì†Œê²¬, ì¹˜ë£Œ ê³„íš ë“±)
- ì²˜ë°© ìƒì„¸ ì •ë³´ (ì•½ë¬¼ ìƒí˜¸ì‘ìš©, ì•Œë ˆë¥´ê¸° ì²´í¬ ë“±)
- ì§„ë‹¨ ì½”ë“œ ìƒì„¸ (ICD-10, KCD ë§¤í•‘)

**ì—°ë™ ë°©ì‹ (v3.0)**:
- **Direct Database Access**: Django Database Routerë¥¼ í†µí•´ `patient_data` í…Œì´ë¸” ì§ì ‘ CRUD
- **Outbox Pattern**: ë°ì´í„° ë³€ê²½ ì‹œ `emr.models.SyncOutbox`ì— ì´ë²¤íŠ¸ ì €ì¥ í›„ ë¹„ë™ê¸° ë™ê¸°í™”

**ë°ì´í„° íë¦„ (v3.0)**:
```
Django (Service Layer) â†’ Outbox (INSERT) â†’ Celery Worker â†’ [Direct SQL] â†’ OpenEMR DB
```

---

### 3. HAPI FHIR R4 (ë°ì´í„° êµí™˜ í‘œì¤€)

**ìš©ë„**: ì‹œìŠ¤í…œ ê°„ ë°ì´í„° êµí™˜ (í‘œì¤€ ì¸í„°í˜ì´ìŠ¤)

**ë™ê¸°í™” ë°©ì‹ (v3.0)**:
- OpenEMRê³¼ ë™ì¼í•œ **Outbox Pattern** ì‚¬ìš©
- í•„ìš” ì‹œ FHIR DBì—ë„ Direct Access ë˜ëŠ” FHIR REST API ì‚¬ìš© (ì„¤ì •ì— ë”°ë¦„)

---

## ğŸ”„ ë°ì´í„° íë¦„ ì‹œë‚˜ë¦¬ì˜¤ (v3.0)

### 1. EMR ë°ì´í„° ë™ê¸°í™” (í™˜ì ìƒì„±)

**êµ¬í˜„**:
```
1. ì‚¬ìš©ì ìš”ì²­ (API)
2. Service Layer (Transaction Start)
   â”œâ”€ PatientCache ì €ì¥ (Local DB)
   â”œâ”€ SyncOutbox ì €ì¥ (status='pending')
   â””â”€ Transaction Commit
3. Async Task ì‹¤í–‰
   â”œâ”€ Outbox ì¡°íšŒ
   â”œâ”€ OpenEMR DB ì§ì ‘ ì ‘ì† (INSERT/UPDATE)
   â””â”€ ì™„ë£Œ ì²˜ë¦¬ (status='done')
```

**ì¥ì **:
- OpenEMR ì¥ì•  ì‹œì—ë„ ë¡œì»¬ ì‘ì—…ì€ ì„±ê³µ
- API ì˜¤ë²„í—¤ë“œ ì—†ì´ ê³ ì† ë™ê¸°í™”

---

### 4. Orthanc PACS (DICOM ì´ë¯¸ì§€)

**ìš©ë„**: ì˜ë£Œ ì˜ìƒ ì €ì¥ ë° DICOM ì„œë¹„ìŠ¤

**ì €ì¥ ë°ì´í„°**:
- DICOM ì›ë³¸ ì´ë¯¸ì§€ (CT, MRI, X-Ray ë“±)
- AI ìƒì„± Segmentation ì´ë¯¸ì§€ (ì˜ì‚¬ ìŠ¹ì¸ í›„)

**ì—°ë™ ë°©ì‹**:
- Django â†’ Orthanc REST API
- DICOM ì—…ë¡œë“œ: `POST /instances`
- DICOM ì¡°íšŒ: `GET /studies/{id}`

---

## ğŸ”„ ë°ì´í„° íë¦„ ì‹œë‚˜ë¦¬ì˜¤

### 1. EMR/OCS ë°ì´í„° íë¦„ (í™˜ì, ì§„ë£Œ, ì²˜ë°©)

**ìš”êµ¬ì‚¬í•­**:
> "djangoë¡œ ë“¤ì–´ì˜¤ëŠ” í™˜ì ì •ë³´, OCSëŠ” ë‹¤ìŒ 3ê°œ ì €ì¥ê³µê°„ì— CRUDëœë‹¤.
> mysql, open_emr, FHIR
> ë‹¤ë§Œ, mysqlì—ëŠ” ê¸°ë³¸ì •ë³´(list_up í–ˆì„ë•Œ ë³´ì´ëŠ” ì •ë³´)ë§Œ ìˆê³  ìƒì„¸(detail)ì •ë³´ëŠ” ì—†ë‹¤."

**í˜„ì¬ êµ¬í˜„**:

#### í™˜ì ìƒì„± ì‹œ:
```
1. API ìš”ì²­ â†’ Django ORM
2. PatientCache.objects.create()
   â”œâ”€ Django MySQL: ê¸°ë³¸ ì •ë³´ ì €ì¥ (ì´ë¦„, ìƒë…„ì›”ì¼, ì„±ë³„ ë“±)
   â”œâ”€ EMR Signal: OpenEMR FHIR APIë¡œ Patient ìƒì„± (ìƒì„¸ ì •ë³´ í¬í•¨)
   â”‚  â””â”€ openemr_patient_id ì €ì¥
   â””â”€ FHIR Signal: HAPI FHIRì— Patient ë¦¬ì†ŒìŠ¤ ìë™ ìƒì„± (êµí™˜ìš©)
```

#### í™˜ì ìƒì„¸ ì¡°íšŒ ì‹œ:
```
1. ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ (GET /api/patients/):
   - Django MySQLì˜ PatientCacheì—ì„œ ë¹ ë¥´ê²Œ ì¡°íšŒ
   - SELECT * FROM emr_patient_cache
   - ê¸°ë³¸ ì •ë³´ë§Œ ë°˜í™˜

2. ìƒì„¸ ì¡°íšŒ (GET /api/patients/{id}/):
   - Django MySQL: ê¸°ë³¸ ì •ë³´ ì¡°íšŒ
   - OpenEMR FHIR API: ìƒì„¸ ì •ë³´ ì¡°íšŒ (openemr_patient_id ì‚¬ìš©)
   - ë‘ ë°ì´í„° ë³‘í•©í•˜ì—¬ ë°˜í™˜
   Response:
   {
     "data": { /* PatientCache ê¸°ë³¸ ì •ë³´ */ },
     "openemr_detail": { /* OpenEMR ìƒì„¸ ì •ë³´ */ }
   }
```

#### í™˜ì ìˆ˜ì • ì‹œ:
```
1. API ìš”ì²­ â†’ Django ORM
2. PatientCache.save()
   â”œâ”€ Django MySQL: ê¸°ë³¸ ì •ë³´ ì—…ë°ì´íŠ¸
   â”œâ”€ EMR Signal: OpenEMR FHIR APIë¡œ Patient ì—…ë°ì´íŠ¸ (ìƒì„¸ ì •ë³´)
   â””â”€ FHIR Signal: HAPI FHIR Patient ë¦¬ì†ŒìŠ¤ ìë™ ì—…ë°ì´íŠ¸ (êµí™˜ìš©)
```

**êµ¬í˜„ ìƒíƒœ**:
- âœ… Django MySQL ì €ì¥
- âœ… FHIR ìë™ ë™ê¸°í™” (PatientCache)
- âœ… OpenEMR ì—°ë™ ì™„ë£Œ
  - âœ… OpenEMR FHIR API í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„
  - âœ… PatientCache signalsë¡œ ìë™ ë™ê¸°í™”
  - âœ… ìƒì„¸ ì¡°íšŒ ì‹œ OpenEMR ë°ì´í„° ë³‘í•©

---

### 2. LIS ë°ì´í„° íë¦„ (ê²€ì‚¬, ìœ ì „ ì •ë³´)

**ìš”êµ¬ì‚¬í•­**:
> "lisì—ì„œ ë“¤ì–´ì˜¤ëŠ” ìœ ì „ ì •ë³´ëŠ” mysqlì— ì €ì¥ëœë‹¤."

**í˜„ì¬ êµ¬í˜„**:

#### ê²€ì‚¬ ê²°ê³¼ ì €ì¥:
```
1. API ìš”ì²­ â†’ Django ORM
2. LabResult.objects.create()
   â”œâ”€ Django MySQL: ê²€ì‚¬ ê²°ê³¼ ì „ì²´ ì €ì¥ (ìœ ì „ ì •ë³´ í¬í•¨)
   â”‚  - test_code, result_value, result_unit
   â”‚  - result_details (JSONField): ìœ ì „ ì •ë³´ ë“± ìƒì„¸ ë°ì´í„°
   â””â”€ ë (OpenEMR, FHIRì—ëŠ” ì €ì¥ ì•ˆ í•¨)
```

#### ê²€ì‚¬ ê²°ê³¼ ì¡°íšŒ:
```
1. ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ:
   - SELECT * FROM lis_lab_results WHERE patient_id = ?

2. ìƒì„¸ ì¡°íšŒ:
   - SELECT * FROM lis_lab_results WHERE result_id = ?
   - result_details (JSON)ì— ìœ ì „ ì •ë³´ í¬í•¨
```

**êµ¬í˜„ ìƒíƒœ**:
- âœ… Django MySQLì— ì™„ì „í•œ ë°ì´í„° ì €ì¥
- âœ… `result_details` (JSONField)ë¡œ ìœ ì „ ì •ë³´ ì €ì¥ ê°€ëŠ¥
- âœ… OpenEMR, FHIR ì—°ë™ ë¶ˆí•„ìš” (MySQLë§Œ ì‚¬ìš©)

**ëª¨ë¸ êµ¬ì¡°**:
```python
class LabResult(models.Model):
    result_id = models.CharField(max_length=20, primary_key=True)
    order = models.ForeignKey(Order, on_delete=models.CASCADE)
    patient = models.ForeignKey(PatientCache, on_delete=models.CASCADE)
    test_master = models.ForeignKey(LabTestMaster, on_delete=models.PROTECT)

    result_value = models.CharField(max_length=100)
    result_unit = models.CharField(max_length=50)

    # ìœ ì „ ì •ë³´ëŠ” ì—¬ê¸°ì— JSONìœ¼ë¡œ ì €ì¥
    result_details = models.JSONField(blank=True, null=True)

    is_abnormal = models.BooleanField(default=False)
    reported_at = models.DateTimeField(auto_now_add=True)
```

**ìœ ì „ ì •ë³´ ì˜ˆì‹œ**:
```json
{
  "gene": "BRCA1",
  "variant": "c.68_69delAG",
  "zygosity": "heterozygous",
  "pathogenicity": "pathogenic",
  "clinical_significance": "High risk for breast/ovarian cancer",
  "raw_data": "..."
}
```

---

### 3. AI ì¶”ë¡  ê²°ê³¼ ë°ì´í„° íë¦„

**ìš”êµ¬ì‚¬í•­**:
> "ai_ì¶”ë¡ ì˜ ê²°ê³¼ì¤‘ txt, 2ì§„, intí˜• ë°ì´í„°ëŠ” mysqlì— ì €ì¥í•˜ê³ 
> ì´ë¯¸ì§€(seg)ëŠ” vmì— ì €ì¥í–ˆë‹¤ê°€ ì˜ì‚¬ê°€ 'seg_ì €ì¥'ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ orthanceì— ì €ì¥ëœë‹¤."

**í˜„ì¬ êµ¬í˜„**:

#### AI ì¶”ë¡  ì‹¤í–‰:
```
1. API ìš”ì²­ â†’ Celery Task
2. AI ëª¨ë¸ ì‹¤í–‰ â†’ ê²°ê³¼ ìƒì„±
   â”œâ”€ í…ìŠ¤íŠ¸/ìˆ«ì ê²°ê³¼: AIJob.result_data (JSONField)ì— ì €ì¥
   â””â”€ Segmentation ì´ë¯¸ì§€: VM ì„ì‹œ ì €ì¥
3. AIJob.status = 'COMPLETED'
4. Django MySQLì— ì €ì¥
```

#### Segmentation ì´ë¯¸ì§€ íë¦„:
```
1. AI ì¶”ë¡  ì™„ë£Œ â†’ Seg ì´ë¯¸ì§€ VMì— ì„ì‹œ ì €ì¥
   - ê²½ë¡œ: /vm/ai_results/{job_id}/segmentation.nii.gz

2. ì˜ì‚¬ ê²€í† :
   - AIJob.review_status = 'PENDING'
   - ì˜ì‚¬ê°€ Viewerì—ì„œ Seg í™•ì¸

3. ì˜ì‚¬ê°€ 'seg_ì €ì¥' ë²„íŠ¼ í´ë¦­:
   â”œâ”€ AIJob.review_status = 'APPROVED'
   â”œâ”€ Seg ì´ë¯¸ì§€ë¥¼ DICOM Segmentation Objectë¡œ ë³€í™˜
   â”œâ”€ Orthancì— ì—…ë¡œë“œ (POST /instances)
   â””â”€ VM ì„ì‹œ íŒŒì¼ ì‚­ì œ (ì„ íƒì )
```

**êµ¬í˜„ ìƒíƒœ**:
- âœ… AIJob ëª¨ë¸ì— result_data (JSONField) ìˆìŒ
- âœ… review_status, reviewed_by í•„ë“œ ìˆìŒ
- âŒ Seg ì´ë¯¸ì§€ VM ì €ì¥ ë¡œì§ (TODO)
- âŒ Seg â†’ DICOM ë³€í™˜ ë° Orthanc ì—…ë¡œë“œ (TODO)

**ëª¨ë¸ êµ¬ì¡°**:
```python
class AIJob(models.Model):
    job_id = models.UUIDField(primary_key=True)
    study_id = models.UUIDField()
    model_type = models.CharField(max_length=50)
    status = models.CharField(max_length=20)  # COMPLETED, FAILED ë“±

    # í…ìŠ¤íŠ¸/ìˆ«ì ê²°ê³¼ëŠ” ì—¬ê¸°ì— JSONìœ¼ë¡œ ì €ì¥
    result_data = models.JSONField(null=True, blank=True)

    # ì˜ë£Œì§„ ê²€í† 
    review_status = models.CharField(max_length=20)  # PENDING, APPROVED, REJECTED
    reviewed_by = models.ForeignKey(User, ...)
    reviewed_at = models.DateTimeField(null=True)
    review_comment = models.TextField(blank=True)
```

**result_data ì˜ˆì‹œ** (í…ìŠ¤íŠ¸/ìˆ«ì):
```json
{
  "tumor_detected": true,
  "tumor_volume_ml": 15.3,
  "tumor_location": "right frontal lobe",
  "confidence_score": 0.92,
  "bounding_box": [120, 140, 80, 100, 60, 80],
  "segmentation_path": "/vm/ai_results/abc-123/seg.nii.gz"  # VM ê²½ë¡œ ì°¸ì¡°
}
```

**í•„ìš”í•œ ì‘ì—…**:
1. Celery Taskì—ì„œ Seg ì´ë¯¸ì§€ VM ì €ì¥ ë¡œì§ ì¶”ê°€
2. API ì—”ë“œí¬ì¸íŠ¸: `POST /ai/jobs/{job_id}/approve-segmentation/`
3. Seg â†’ DICOM Segmentation Object ë³€í™˜ ìœ í‹¸ë¦¬í‹°
4. Orthanc ì—…ë¡œë“œ ë¡œì§

---

## ğŸ“‹ ë°ì´í„° ì €ì¥ì†Œë³„ ì—­í•  ìš”ì•½

| ë°ì´í„° ì¢…ë¥˜ | Django MySQL | OpenEMR | HAPI FHIR | Orthanc | VM |
|------------|-------------|---------|-----------|---------|-----|
| **í™˜ì ê¸°ë³¸ ì •ë³´** | âœ… ìºì‹œ | âœ… ìƒì„¸ | âœ… êµí™˜ | - | - |
| **ì§„ë£Œ ê¸°ë¡** | âœ… ìºì‹œ | âœ… ìƒì„¸ | âœ… êµí™˜ | - | - |
| **ì²˜ë°© ì •ë³´** | âœ… ìºì‹œ | âœ… ìƒì„¸ | âœ… êµí™˜ | - | - |
| **LIS ê²€ì‚¬ ê²°ê³¼** | âœ… ì™„ì „ | - | - | - | - |
| **ìœ ì „ ì •ë³´** | âœ… ì™„ì „ | - | - | - | - |
| **AI í…ìŠ¤íŠ¸/ìˆ«ì** | âœ… ì™„ì „ | - | - | - | - |
| **AI Seg ì´ë¯¸ì§€ (ì„ì‹œ)** | - | - | - | - | âœ… ì„ì‹œ |
| **AI Seg ì´ë¯¸ì§€ (ìŠ¹ì¸ í›„)** | - | - | - | âœ… ì˜êµ¬ | - |
| **DICOM ì›ë³¸** | - | - | - | âœ… ì˜êµ¬ | - |

**ë²”ë¡€**:
- âœ… ìºì‹œ: ë¹ ë¥¸ ì¡°íšŒìš©, ìƒì„¸ ì •ë³´ ì—†ìŒ
- âœ… ì™„ì „: ëª¨ë“  ë°ì´í„° ì €ì¥
- âœ… ìƒì„¸: ìƒì„¸ ì •ë³´ë§Œ ì €ì¥
- âœ… êµí™˜: í‘œì¤€ í¬ë§·ìœ¼ë¡œ ì €ì¥
- âœ… ì„ì‹œ: ì„ì‹œ ì €ì¥
- âœ… ì˜êµ¬: ì˜êµ¬ ì €ì¥

---

## ğŸ”§ í˜„ì¬ êµ¬í˜„ ìƒíƒœ

### âœ… ì™„ë£Œëœ ê¸°ëŠ¥

1. **Django MySQL ì €ì¥**:
   - PatientCache, Encounter, Order ëª¨ë¸
   - LabResult ëª¨ë¸ (ìœ ì „ ì •ë³´ í¬í•¨)
   - AIJob ëª¨ë¸ (í…ìŠ¤íŠ¸/ìˆ«ì ê²°ê³¼)
   - RadiologyStudy ëª¨ë¸ (DICOM ë©”íƒ€ë°ì´í„°)

2. **FHIR ìë™ ë™ê¸°í™”** (HAPI FHIR):
   - PatientCache â†’ FHIR Patient
   - Django signals (post_save, post_delete)
   - fhir_id í•„ë“œë¡œ ì–‘ë°©í–¥ ë§¤í•‘

3. **OpenEMR ì—°ë™** â­ NEW (v3.0 Direct DB):
   - âœ… **Django Database Router**: `emr/router.py` (OpenEMR DB ë¼ìš°íŒ…)
   - âœ… **Direct Repositories**: `OpenEMRPatientRepository` (SQL/ORM ì§ì ‘ ì ‘ê·¼)
   - âœ… **Outbox Pattern**: `emr/tasks.py` (ë¹„ë™ê¸° ë™ê¸°í™”)

4. **Orthanc ì—°ë™**:
   - DICOM ì—…ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸
   - RadiologyStudy â†” Orthanc ë™ê¸°í™”

### âŒ TODO

1. **FHIR í™•ì¥**:
   - Prescription, LabTest ëª¨ë¸ ìƒì„±
   - MedicationRequest, DiagnosticReport ë™ê¸°í™”

2. **AI Seg ì´ë¯¸ì§€ ì²˜ë¦¬** (P1 - AI ë‹´ë‹¹ì ì‘ì—… í›„):
   - VM ì„ì‹œ ì €ì¥ ë¡œì§
   - Seg â†’ DICOM ë³€í™˜
   - ì˜ì‚¬ ìŠ¹ì¸ í›„ Orthanc ì—…ë¡œë“œ

3. **OpenEMR í™•ì¥** (Optional):
   - Encounter, Order ëª¨ë¸ì—ë„ OpenEMR ë™ê¸°í™” ì¶”ê°€
   - openemr_encounter_id, openemr_order_id í•„ë“œ ì¶”ê°€

---

## ğŸ“ ê´€ë ¨ íŒŒì¼

### Django Models
- `emr/models.py`: PatientCache, Encounter, Order
- `lis/models.py`: LabTestMaster, LabResult
- `ai/models.py`: AIJob
- `ris/models.py`: RadiologyStudy, RadiologyReport

### FHIR ë™ê¸°í™” (HAPI FHIR)
- `fhir/signals.py`: ìë™ ë™ê¸°í™” signals
- `fhir/services/fhir_mapper.py`: Django â†’ FHIR ë³€í™˜
- `fhir/services/fhir_client.py`: HAPI FHIR API í´ë¼ì´ì–¸íŠ¸
- `fhir/apps.py`: FHIR signals í™œì„±í™”

### OpenEMR ì—°ë™ â­ NEW
- `emr/services/openemr_client.py`: OpenEMR FHIR API í´ë¼ì´ì–¸íŠ¸
- `emr/services/openemr_mapper.py`: Django â†” OpenEMR FHIR ë³€í™˜
- `emr/signals.py`: PatientCache ìë™ ë™ê¸°í™” signals
- `emr/apps.py`: EMR signals í™œì„±í™”
- `emr/viewsets.py`: PatientCacheViewSet.retrieve() - ìƒì„¸ ì¡°íšŒ

### Orthanc ì—°ë™
- `ris/clients/orthanc_client.py`: Orthanc REST API í´ë¼ì´ì–¸íŠ¸
- `ris/management/commands/upload_sample_dicoms.py`: DICOM ì—…ë¡œë“œ

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-12-30 18:45
**ë²„ì „**: v1.1 - OpenEMR ì—°ë™ ì™„ë£Œ
