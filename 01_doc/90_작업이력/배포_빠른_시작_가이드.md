# ë°°í¬ ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ (2ì¼ ë‚´ ì„ì‹œ ë°°í¬)

**ì‘ì„±ì¼**: 2025-12-31
**ëŒ€ìƒ**: Solo ë°°í¬ (Django + MySQL + Orthanc + Redis)
**ì œì™¸**: FastAPI, React (íƒ€ íŒ€ì› ì‘ì—…)

---

## âš¡ ë¹ ë¥¸ ì²´í¬ë¦¬ìŠ¤íŠ¸ (30ë¶„)

### 1ë‹¨ê³„: ë¡œì»¬ í™˜ê²½ ìµœì¢… í™•ì¸ (10ë¶„)
```bash
# Docker ì»¨í…Œì´ë„ˆ ìƒíƒœ
docker ps --format "table {{.Names}}\t{{.Status}}"

# Django API í…ŒìŠ¤íŠ¸
curl http://localhost/api/acct/login/ -X POST \
  -H "Content-Type: application/json" \
  -d '{"username":"doctor","password":"doctor123"}'

# í™˜ì ë°ì´í„° í™•ì¸
curl http://localhost/api/emr/patients/ | head -200
```

**âœ… í™•ì¸ ì‚¬í•­**:
- [ ] 14ê°œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì¤‘
- [ ] ë¡œê·¸ì¸ API 200 OK + JWT í† í° ë°˜í™˜
- [ ] í™˜ì 5ëª… ë°ì´í„° ë°˜í™˜

---

### 2ë‹¨ê³„: GCP VM ì¤€ë¹„ (10ë¶„)

**VM ì‚¬ì–‘**:
- **Region**: asia-northeast3 (ì„œìš¸)
- **Zone**: asia-northeast3-a
- **Machine Type**: e2-standard-4 (4 vCPU, 16GB RAM)
- **OS**: Ubuntu 22.04 LTS
- **Disk**: 100GB SSD
- **ì™¸ë¶€ IP**: 34.71.151.117 (ê³ ì • IP)

```bash
# VM ì¸ìŠ¤í„´ìŠ¤ ìƒì„± (GCP Console ë˜ëŠ” gcloud CLI)
gcloud compute instances create neuronova-cdss-vm \
  --zone=asia-northeast3-a \
  --machine-type=e2-standard-4 \
  --network-interface=network-tier=PREMIUM,subnet=default,address=34.71.151.117 \
  --image-family=ubuntu-2204-lts \
  --image-project=ubuntu-os-cloud \
  --boot-disk-size=100GB \
  --boot-disk-type=pd-ssd
```

**ë°©í™”ë²½ ê·œì¹™ ì¶”ê°€**:
```bash
# HTTP/HTTPS í—ˆìš©
gcloud compute firewall-rules create allow-http-https \
  --allow tcp:80,tcp:443 \
  --source-ranges 0.0.0.0/0 \
  --description "Allow HTTP and HTTPS"
```

---

### 3ë‹¨ê³„: VM ì ‘ì† ë° í™˜ê²½ ì„¤ì • (10ë¶„)

```bash
# SSH ì ‘ì†
gcloud compute ssh neuronova-cdss-vm --zone=asia-northeast3-a

# Docker ì„¤ì¹˜
sudo apt-get update
sudo apt-get install -y docker.io docker-compose
sudo systemctl start docker
sudo systemctl enable docker
sudo usermod -aG docker $USER

# Git ì„¤ì¹˜ ë° ì½”ë“œ clone
sudo apt-get install -y git
git clone https://github.com/YOUR_ORG/NeuroNova_v1.git
cd NeuroNova_v1
```

---

## ğŸ“‹ ìƒì„¸ ë°°í¬ ì ˆì°¨

### Phase 1: í”„ë¡œë•ì…˜ í™˜ê²½ ì„¤ì • (30ë¶„)

#### 1.1 .env íŒŒì¼ ìƒì„±
```bash
cd NeuroNova_02_back_end/02_django_server
cp .env.example .env
```

**í•„ìˆ˜ ìˆ˜ì • í•­ëª©**:
```bash
# .env íŒŒì¼ í¸ì§‘
nano .env

# ì¤‘ìš”: ì•„ë˜ ê°’ë“¤ì„ ë°˜ë“œì‹œ ë³€ê²½!
DEBUG=False
SECRET_KEY=<GENERATE_NEW_SECRET_KEY>  # python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
ALLOWED_HOSTS=34.71.151.117,neuronova.example.com

# ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
DB_PASSWORD=<STRONG_PASSWORD>
OPENEMR_DB_PASSWORD=<STRONG_PASSWORD>

# CORS ì„¤ì • (í”„ë¡œë•ì…˜ ë„ë©”ì¸)
CORS_ALLOWED_ORIGINS=https://neuronova.example.com

# Celery ì„¤ì •
CELERY_BROKER_URL=redis://redis:6379/0
```

#### 1.2 MySQL ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
```bash
# docker-compose.dev.yml ë˜ëŠ” .envì—ì„œ MySQL ë¹„ë°€ë²ˆí˜¸ ìˆ˜ì •
# MYSQL_ROOT_PASSWORD, MYSQL_PASSWORD ë³€ê²½
```

---

### Phase 2: Docker ì»¨í…Œì´ë„ˆ ë¹Œë“œ ë° ì‹¤í–‰ (20ë¶„)

```bash
# ë£¨íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /home/YOUR_USER/NeuroNova_v1

# Docker ë„¤íŠ¸ì›Œí¬ ìƒì„±
docker network create neuronova_network

# ì „ì²´ ìŠ¤íƒ ì‹œì‘
docker-compose -f docker-compose.dev.yml up -d --build

# ë¹Œë“œ ì§„í–‰ ìƒí™© í™•ì¸
docker-compose -f docker-compose.dev.yml logs -f django
```

**ì˜ˆìƒ ë¹Œë“œ ì‹œê°„**: 5-10ë¶„

---

### Phase 3: ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” (10ë¶„)

```bash
# Django ë§ˆì´ê·¸ë ˆì´ì…˜
docker-compose -f docker-compose.dev.yml exec django python manage.py migrate

# ì •ì  íŒŒì¼ ìˆ˜ì§‘
docker-compose -f docker-compose.dev.yml exec django python manage.py collectstatic --noinput

# í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„±
docker-compose -f docker-compose.dev.yml exec django python manage.py create_test_users

# ìƒ˜í”Œ í™˜ì ë°ì´í„° ìƒì„±
docker-compose -f docker-compose.dev.yml exec django python manage.py init_sample_data
```

---

### Phase 4: ë°°í¬ ê²€ì¦ (15ë¶„)

#### 4.1 ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
```bash
docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"
```

**âœ… í™•ì¸**: 14ê°œ ì»¨í…Œì´ë„ˆ ëª¨ë‘ Up ìƒíƒœ

#### 4.2 API í…ŒìŠ¤íŠ¸
```bash
# VM ë‚´ë¶€ì—ì„œ í…ŒìŠ¤íŠ¸
curl http://localhost/api/acct/login/ -X POST \
  -H "Content-Type: application/json" \
  -d '{"username":"doctor","password":"doctor123"}'

# ì™¸ë¶€ì—ì„œ í…ŒìŠ¤íŠ¸ (ë‹¤ë¥¸ í„°ë¯¸ë„ì—ì„œ)
curl http://34.71.151.117/api/acct/login/ -X POST \
  -H "Content-Type: application/json" \
  -d '{"username":"doctor","password":"doctor123"}'
```

**âœ… ì˜ˆìƒ ì‘ë‹µ**: JWT í† í° ë°œê¸‰ ì„±ê³µ

#### 4.3 í™˜ì ë°ì´í„° í™•ì¸
```bash
curl http://localhost/api/emr/patients/ | head -200
```

**âœ… ì˜ˆìƒ ê²°ê³¼**: 5ëª… í™˜ì ë°˜í™˜

---

## ğŸ”’ ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•„ìˆ˜ ë³´ì•ˆ ì„¤ì •
- [x] DEBUG=False ì„¤ì •
- [x] SECRET_KEY ìƒˆë¡œ ìƒì„± ë° í™˜ê²½ë³€ìˆ˜í™”
- [x] ALLOWED_HOSTS ì œí•œ (IP, ë„ë©”ì¸ë§Œ í—ˆìš©)
- [x] MySQL ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ (ê¸°ë³¸ê°’ ê¸ˆì§€)
- [x] CORS_ALLOWED_ORIGINS í”„ë¡œë•ì…˜ ë„ë©”ì¸ë§Œ í—ˆìš©
- [ ] HTTPS ì„¤ì • (Let's Encrypt ë˜ëŠ” Cloudflare)
- [ ] Firewall ê·œì¹™ ìµœì†Œí™” (80, 443ë§Œ í—ˆìš©)
- [ ] SSH í‚¤ ê¸°ë°˜ ì¸ì¦ (ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸ ë¹„í™œì„±í™”)

### ê¶Œì¥ ë³´ì•ˆ ì„¤ì •
- [ ] JWT Access Token ë§Œë£Œ ì‹œê°„ ë‹¨ì¶• (1ì‹œê°„)
- [ ] Refresh Token rotation í™œì„±í™”
- [ ] Rate limiting ì„¤ì • (Nginx)
- [ ] ë¡œê·¸ íŒŒì¼ ê¶Œí•œ ì„¤ì • (600)
- [ ] Docker ë³¼ë¥¨ ë°±ì—… ìŠ¤í¬ë¦½íŠ¸

---

## ğŸš¨ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ì§€ ì•ŠìŒ
```bash
# ë¡œê·¸ í™•ì¸
docker-compose -f docker-compose.dev.yml logs django

# ì¼ë°˜ì ì¸ ì›ì¸:
# - .env íŒŒì¼ ëˆ„ë½ ë˜ëŠ” ì˜ëª»ëœ ì„¤ì •
# - í¬íŠ¸ ì¶©ëŒ (80, 8042 ë“±)
# - ë””ìŠ¤í¬ ê³µê°„ ë¶€ì¡±
```

**í•´ê²°**:
```bash
# ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
docker-compose -f docker-compose.dev.yml down
docker-compose -f docker-compose.dev.yml up -d

# ë””ìŠ¤í¬ ê³µê°„ í™•ì¸
df -h
```

### ë¬¸ì œ 2: API 500 ì—ëŸ¬
```bash
# Django ë¡œê·¸ í™•ì¸
docker logs neuronova-django-dev --tail 100

# ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
docker exec neuronova-django-dev python manage.py dbshell
```

### ë¬¸ì œ 3: ì™¸ë¶€ì—ì„œ ì ‘ì† ë¶ˆê°€
```bash
# ë°©í™”ë²½ ê·œì¹™ í™•ì¸
gcloud compute firewall-rules list

# Nginx ì„¤ì • í™•ì¸
docker exec neuronova-nginx-dev cat /etc/nginx/conf.d/default.conf
```

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§

### Prometheus + Grafana
- **Prometheus**: http://34.71.151.117:9090
- **Grafana**: http://34.71.151.117:3000
  - ê¸°ë³¸ ê³„ì •: admin / admin123
  - ì²« ë¡œê·¸ì¸ ì‹œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í•„ìˆ˜!

### ë¡œê·¸ í™•ì¸
```bash
# Django ë¡œê·¸
docker logs neuronova-django-dev -f

# Nginx ë¡œê·¸
docker logs neuronova-nginx-dev -f

# Celery Worker ë¡œê·¸
docker logs celery-worker -f
```

---

## ğŸ”„ ë°°í¬ í›„ ì‘ì—…

### ì¦‰ì‹œ ì‹¤í–‰
1. **Grafana ë¹„ë°€ë²ˆí˜¸ ë³€ê²½**
2. **HTTPS ì„¤ì •** (Let's Encrypt)
3. **ë°±ì—… ìŠ¤í¬ë¦½íŠ¸ ì„¤ì •** (MySQL, Docker ë³¼ë¥¨)
4. **ëª¨ë‹ˆí„°ë§ ì•Œë¦¼ ì„¤ì •** (ë””ìŠ¤í¬, CPU, ë©”ëª¨ë¦¬)

### 1ì£¼ì¼ ë‚´
1. **ë¶€í•˜ í…ŒìŠ¤íŠ¸** (ë™ì‹œ ì‚¬ìš©ì 100ëª…)
2. **ë¡œê·¸ ë¡œí…Œì´ì…˜ ì„¤ì •**
3. **ìë™ ì—…ë°ì´íŠ¸ ìŠ¤í¬ë¦½íŠ¸**

---

## ğŸ“ ì°¸ê³  ë¬¸ì„œ

- **ìƒì„¸ ë°°í¬ ê°€ì´ë“œ**: [01_doc/12_GCP_ë°°í¬_ê°€ì´ë“œ.md](../../12_GCP_ë°°í¬_ê°€ì´ë“œ.md)
- **ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸**: [01_doc/13_ë°°í¬ì „_ë³´ì•ˆ_ì²´í¬ë¦¬ìŠ¤íŠ¸.md](../../13_ë°°í¬ì „_ë³´ì•ˆ_ì²´í¬ë¦¬ìŠ¤íŠ¸.md)
- **í…ŒìŠ¤íŠ¸ ê²°ê³¼**: [ë°°í¬ì „_í…ŒìŠ¤íŠ¸_ê²°ê³¼_1231.md](ë°°í¬ì „_í…ŒìŠ¤íŠ¸_ê²°ê³¼_1231.md)

---

**ì‘ì„±ì**: Claude AI
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-12-31
**ì˜ˆìƒ ë°°í¬ ì‹œê°„**: 1-2ì‹œê°„ (VM ìƒì„± ~ ê²€ì¦ ì™„ë£Œ)
