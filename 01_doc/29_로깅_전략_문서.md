# 로깅 전략 문서 (Logging Strategy Guide)

**최종 수정일**: 2025-12-29
**목적**: 시스템 운영 효율성 및 문제 해결을 위한 표준화된 로깅 방식 정의

---

## 1. 개요

백엔드 시스템에서 발생하는 모든 유의미한 활동을 기록하여 **장애 대응**, **비즈니스 분석**, **보안 감사**를 용이하게 합니다.

## 2. 로깅 레벨 정의

| 레벨 | 설명 | 대상 |
|------|------|------|
| **DEBUG** | 개발 단계 상세 정보 | SQL 쿼리, 상세 변수값 (운영 환경 비활성) |
| **INFO** | 흐름 파악용 정보 | API 요청/응답 시작, 외부 서버 통신 성공 |
| **WARNING** | 잠재적 문제 | 권한 부족 접근, 유효하지 않은 입력 시도 |
| **ERROR** | 로직 수행 실패 | DB 연결 에러, 비즈니스 로직 예외, 시스템 오류 |
| **CRITICAL** | 시스템 중단 위기 | 메모리 부족, 하드웨어 장애, 데이터 소실 위기 |

## 3. 구조화된 로깅 (Structured Logging)

모든 로그는 검색이 용이하도록 **JSON 형식** 또는 **표준화된 텍스트** 형식을 따릅니다.

### 3.1 로그 공통 필드
- `timestamp`: 발생 시각 (ISO8601)
- `level`: 로그 레벨
- `app_name`: 어플리케이션 명 (emr, acct 등)
- `request_id`: 개별 요청 추적을 위한 UUID
- `user_id`: 요청 사용자 ID
- `ip`: 접근 IP

## 4. 개인정보 및 민감정보 보호 (Masking)

로그에 민감한 정보가 노출되지 않도록 마스킹 처리합니다.

- **주민등록번호 (SSN)**: 앞 6자리만 남기고 마스킹 (`900101-*******`)
- **비밀번호**: 절대 로깅 금지
- **이메일/전화번호**: 중간 일부 마스킹

## 5. 저장 및 로테이션 정책

로그 파일의 무한 증식을 방지하기 위해 로테이션을 수행합니다.

- **저장 경로**: `logs/` 디렉토리
- **파일 분할**:
  - `access.log`: HTTP 요청/응답 기록
  - `error.log`: ERROR 레벨 이상 로그
  - `app.log`: 비즈니스 로직 일반 로그
- **로테이션 규칙**:
  - **Daily**: 매일 자정 새로운 파일 생성
  - **보관 기간**: 최근 30일 (운영 환경 정책에 따라 조절)

## 6. 구현 가이드 (Django)

### 6.1 Middleware (Access Log)
모든 API 요청의 경로, 메서드, 처리 시간을 기록합니다.

### 6.2 Service Layer Logging
중요 데이터 생성/수정/삭제 시 `INFO` 레벨로 기록합니다.

## 7. 체크리스트
- [ ] 에러 로그에 Stack Trace가 포함되어 있는가?
- [ ] 마스킹 규칙이 제대로 적용되었는가?
- [ ] 운영 환경에서 DEBUG 로그가 꺼져있는가?
