# 38. ë°ì´í„° ì´ˆê¸°í™” ê°€ì´ë“œ

**ì‘ì„±ì¼**: 2025-12-30
**ë²„ì „**: 2.0 (docker-compose.dev.yml í†µí•© í™˜ê²½ ê¸°ì¤€)
**ëª©ì **: Docker í†µí•© í™˜ê²½ì—ì„œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¹ ë¥´ê²Œ ì´ˆê¸°í™”í•˜ëŠ” ë°©ë²•

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [ì „ì œ ì¡°ê±´](#ì „ì œ-ì¡°ê±´)
3. [ë¹ ë¥¸ ì‹œì‘ (3ë‹¨ê³„)](#ë¹ ë¥¸-ì‹œì‘-3ë‹¨ê³„)
4. [ë°ì´í„° ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸](#ë°ì´í„°-ì´ˆê¸°í™”-ìŠ¤í¬ë¦½íŠ¸)
5. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)

---

## ğŸ¯ ê°œìš”

NeuroNova CDSS í†µí•© Docker í™˜ê²½ì—ì„œ ê°œë°œ ë° í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.

**ì§€ì› í™˜ê²½**:
- âœ… **docker-compose.dev.yml** (14ê°œ ì»¨í…Œì´ë„ˆ í†µí•© í™˜ê²½) - ê¶Œì¥
- âš ï¸ ë ˆê±°ì‹œ ê°œë³„ Docker + ë¡œì»¬ Django (ë” ì´ìƒ ê¶Œì¥í•˜ì§€ ì•ŠìŒ)

---

## ğŸ”§ ì „ì œ ì¡°ê±´

### Docker í†µí•© í™˜ê²½ ì‹¤í–‰

ì „ì²´ ìŠ¤íƒì´ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤:

```powershell
# ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ì‹¤í–‰
cd d:\1222\NeuroNova_v1

# ì „ì²´ ìŠ¤íƒ ì‹œì‘ (14ê°œ ì»¨í…Œì´ë„ˆ)
docker-compose -f docker-compose.dev.yml up -d

# ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸ (ëª¨ë‘ healthy ë˜ëŠ” running ìƒíƒœ í™•ì¸)
docker-compose -f docker-compose.dev.yml ps
```

**í•„ìˆ˜ ì„œë¹„ìŠ¤ í™•ì¸**:
- âœ… django (healthy)
- âœ… cdss-mysql (healthy)
- âœ… orthanc (healthy)
- âœ… redis (healthy)
- âœ… celery-worker (running)

---

## ğŸš€ ë¹ ë¥¸ ì‹œì‘ (3ë‹¨ê³„)

### Step 1: í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„±

```powershell
# Django ì»¨í…Œì´ë„ˆì—ì„œ ì‹¤í–‰
docker-compose -f docker-compose.dev.yml exec django python manage.py create_test_users
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```
[SUCCESS] Updated user: admin (admin)
[SUCCESS] Updated user: doctor (doctor)
[SUCCESS] Updated user: nurse (nurse)
...
[SUMMARY] 13 users updated
```

**ìƒì„±ë˜ëŠ” ê³„ì •**:
| ì—­í•  | Username | Password | ë¹„ê³  |
|------|----------|----------|------|
| Admin | admin | admin123!@# | ì‹œìŠ¤í…œ ê´€ë¦¬ì |
| Doctor | doctor | doctor123!@# | ì˜ì‚¬ |
| Nurse | nurse | nurse123!@# | ê°„í˜¸ì‚¬ |
| Patient | patient | patient123!@# | í™˜ì |
| Radiologist | radiologist | rib123!@# | ì˜ìƒì˜í•™ê³¼ |
| Lab Tech | labtech | lab123!@# | ì„ìƒë³‘ë¦¬ì‚¬ |

---

### Step 2: ìƒ˜í”Œ ë°ì´í„° ì´ˆê¸°í™”

```powershell
# ê¸°ì¡´ ë°ì´í„° ìœ ì§€í•˜ê³  ì¶”ê°€
docker-compose -f docker-compose.dev.yml exec django python manage.py init_sample_data

# ë˜ëŠ” ê¸°ì¡´ ë°ì´í„° ì‚­ì œ í›„ ì¬ìƒì„±
docker-compose -f docker-compose.dev.yml exec django python manage.py init_sample_data --reset
```

**ìƒì„±ë˜ëŠ” ë°ì´í„°**:
- ğŸ‘¥ **ì‚¬ìš©ì 7ëª…**: admin, doctor1, doctor2, radiologist1, nurse1, tech1, researcher1
- ğŸ¥ **í™˜ì 5ëª…**: P20250001 ~ P20250005 (Kim MinJun, Lee SeoYun, Park JiHoon, Choi YeJin, Jung DoHyun)

**ì¶œë ¥ ì˜ˆì‹œ**:
```
[START] Sample data initialization...
[USERS] Creating users...
   [OK] User created: admin (admin)
   [OK] User created: doctor1 (doctor)
   ...
[PATIENTS] Creating patients...
   [OK] Patient created: P20250001 - Kim MinJun
   ...

============================================================
[SUMMARY] Sample Data
============================================================

[USERS] Created/Updated: 7
   - admin: admin
   - doctor: doctor1
   ...

[PATIENTS] Created: 5
   - P20250001: Kim MinJun
   - P20250002: Lee SeoYun
   ...

[DB] Total Patients: 5
[DB] Total Users: 13

============================================================
[COMPLETE] All done!
============================================================
```

---

### Step 3: DICOM ìƒ˜í”Œ ì—…ë¡œë“œ (ì„ íƒì‚¬í•­)

```powershell
# Dry-run ëª¨ë“œë¡œ íŒŒì¼ ê²€ì‚¬ë§Œ (ì‹¤ì œ ì—…ë¡œë“œ ì•ˆ í•¨)
docker-compose -f docker-compose.dev.yml exec django python manage.py upload_sample_dicoms --dry-run

# ì‹¤ì œ ì—…ë¡œë“œ
docker-compose -f docker-compose.dev.yml exec django python manage.py upload_sample_dicoms
```

**ê²€ì¶œëœ íŒŒì¼**: 1,860ê°œ DICOM íŒŒì¼ (sub-0004, sub-0005)

**ì¶œë ¥ ì˜ˆì‹œ**:
```
[INFO] Scanning DICOM files in: /app/../sample_dicoms
[INFO] Orthanc URL: http://orthanc:8042
[DRY RUN] Files will not be uploaded

[INFO] Scanning sub-0004...
[INFO] Scanning sub-0005...

[SUMMARY] Found 1,860 DICOM files
[STATS] sub-0004: 930 files
[STATS] sub-0005: 930 files

[DRY RUN] Skipped uploading 1,860 files
```

---

## ğŸ“¦ ë°ì´í„° ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸

### 1. create_test_users.py

**íŒŒì¼ ìœ„ì¹˜**: `acct/management/commands/create_test_users.py`

**ê¸°ëŠ¥**:
- 7ê°œ ì—­í• ë³„ í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„± (admin, doctor, nurse, patient, radiologist, labtech, external)
- ì´ 13ê°œ ì‚¬ìš©ì (React í…ŒìŠ¤íŠ¸ìš© + ì›ë³¸ í…ŒìŠ¤íŠ¸ìš©)

**ì‚¬ìš©ë²•**:
```powershell
# Docker í™˜ê²½
docker-compose -f docker-compose.dev.yml exec django python manage.py create_test_users

# ë ˆê±°ì‹œ (ë¡œì»¬ Django)
python manage.py create_test_users
```

---

### 2. init_sample_data.py

**íŒŒì¼ ìœ„ì¹˜**: `acct/management/commands/init_sample_data.py`

**ê¸°ëŠ¥**:
- 7ê°œ ì—­í•  ì‚¬ìš©ì ìƒì„± (doctor1, doctor2, radiologist1, nurse1, tech1, researcher1, admin)
- 5ê°œ í™˜ì ìƒì„± (P20250001 ~ P20250005)
- í™˜ì ìƒì„¸ ì •ë³´ (ì—°ë½ì²˜, ì£¼ì†Œ, í˜ˆì•¡í˜•, ì•ŒëŸ¬ì§€)

**ì‚¬ìš©ë²•**:
```powershell
# ê¸°ë³¸ ì‚¬ìš© (ê¸°ì¡´ ë°ì´í„° ìœ ì§€)
docker-compose -f docker-compose.dev.yml exec django python manage.py init_sample_data

# ì „ì²´ ì¬ìƒì„± (ê¸°ì¡´ ë°ì´í„° ì‚­ì œ)
docker-compose -f docker-compose.dev.yml exec django python manage.py init_sample_data --reset
```

**Windows í˜¸í™˜ì„±**:
- âœ… ëª¨ë“  ì´ëª¨ì§€ ì œê±° (cp949 ì¸ì½”ë”© ì˜¤ë¥˜ í•´ê²°)
- âœ… ASCII í…ìŠ¤íŠ¸ ë§ˆì»¤ ì‚¬ìš© ([INFO], [SUCCESS], [ERROR])

**ìƒì„±ë˜ëŠ” í™˜ì ë°ì´í„°**:
| Patient ID | Name | Birth Date | Gender | Blood Type |
|------------|------|------------|--------|------------|
| P20250001 | Kim MinJun | 1985-05-15 | male | A+ |
| P20250002 | Lee SeoYun | 1990-08-22 | female | B+ |
| P20250003 | Park JiHoon | 1978-03-10 | male | O+ |
| P20250004 | Choi YeJin | 1995-11-30 | female | AB+ |
| P20250005 | Jung DoHyun | 1982-07-18 | male | A- |

---

### 3. upload_sample_dicoms.py

**íŒŒì¼ ìœ„ì¹˜**: `ris/management/commands/upload_sample_dicoms.py`

**ê¸°ëŠ¥**:
- `sample_dicoms` ë””ë ‰í† ë¦¬ì˜ DICOM íŒŒì¼ì„ Orthanc PACSì— ì—…ë¡œë“œ
- ê²€ì¶œëœ íŒŒì¼ ìˆ˜: 1,860ê°œ (sub-0004, sub-0005)

**ì‚¬ìš©ë²•**:
```powershell
# Dry-run ëª¨ë“œ (ì‹¤ì œ ì—…ë¡œë“œ ì•ˆ í•¨)
docker-compose -f docker-compose.dev.yml exec django python manage.py upload_sample_dicoms --dry-run

# ì‹¤ì œ ì—…ë¡œë“œ
docker-compose -f docker-compose.dev.yml exec django python manage.py upload_sample_dicoms
```

**Windows í˜¸í™˜ì„±**:
- âœ… ì´ëª¨ì§€ ì œê±° (cp949 í˜¸í™˜)

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 1. Django ì»¨í…Œì´ë„ˆì— ì ‘ì†í•  ìˆ˜ ì—†ìŒ

**ì¦ìƒ**: `docker-compose exec django` ì‹¤íŒ¨

**í•´ê²°**:
```powershell
# ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker-compose -f docker-compose.dev.yml ps

# Django ì»¨í…Œì´ë„ˆ ë¡œê·¸ í™•ì¸
docker-compose -f docker-compose.dev.yml logs django

# ì»¨í…Œì´ë„ˆê°€ ì—†ë‹¤ë©´ ì¬ì‹œì‘
docker-compose -f docker-compose.dev.yml up -d django
```

---

### 2. ImportError: cannot import name 'UserProfile'

**ì¦ìƒ**: init_sample_data.py ì‹¤í–‰ ì‹œ ImportError ë°œìƒ

**ì›ì¸**: êµ¬ë²„ì „ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© ì¤‘

**í•´ê²°**: ìµœì‹  ìŠ¤í¬ë¦½íŠ¸ë¡œ ì—…ë°ì´íŠ¸ (ì´ë¯¸ ì ìš©ë¨)
- âœ… UserProfile, Role ëª¨ë¸ ì œê±°
- âœ… User, PatientCache ëª¨ë¸ë§Œ ì‚¬ìš©

---

### 3. UnicodeEncodeError (Windows)

**ì¦ìƒ**: `'cp949' codec can't encode character`

**ì›ì¸**: ìŠ¤í¬ë¦½íŠ¸ì— ì´ëª¨ì§€ ë¬¸ì í¬í•¨

**í•´ê²°**: ìµœì‹  ìŠ¤í¬ë¦½íŠ¸ë¡œ ì—…ë°ì´íŠ¸ (ì´ë¯¸ ì ìš©ë¨)
- âœ… ëª¨ë“  ì´ëª¨ì§€ë¥¼ ASCII í…ìŠ¤íŠ¸ë¡œ ë³€ê²½

---

### 4. Orthanc ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ**: Connection refused to Orthanc

**í•´ê²°**:
```powershell
# Orthanc ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker-compose -f docker-compose.dev.yml ps orthanc

# Orthanc í—¬ìŠ¤ì²´í¬
docker-compose -f docker-compose.dev.yml exec orthanc curl http://localhost:8042/system

# Orthanc ë¡œê·¸ í™•ì¸
docker-compose -f docker-compose.dev.yml logs orthanc
```

---

### 5. MySQL ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ**: OperationalError: Can't connect to MySQL

**í•´ê²°**:
```powershell
# MySQL ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker-compose -f docker-compose.dev.yml ps cdss-mysql

# MySQL í—¬ìŠ¤ì²´í¬
docker-compose -f docker-compose.dev.yml exec cdss-mysql mysqladmin ping -h localhost -u root -p

# MySQL ë¡œê·¸ í™•ì¸
docker-compose -f docker-compose.dev.yml logs cdss-mysql
```

---

## ğŸ“ ì™„ì „ ì´ˆê¸°í™” ì‹œë‚˜ë¦¬ì˜¤

Dockerë¥¼ ì™„ì „íˆ ì‚­ì œí•˜ê³  ì¬ì„¤ì¹˜í•œ ê²½ìš°:

```powershell
# 1. ë£¨íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd d:\1222\NeuroNova_v1

# 2. ì „ì²´ ìŠ¤íƒ ì‹œì‘ (14ê°œ ì»¨í…Œì´ë„ˆ)
docker-compose -f docker-compose.dev.yml up -d

# 3. ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸ (ëª¨ë‘ healthy ëŒ€ê¸°)
docker-compose -f docker-compose.dev.yml ps

# 4. Django ë§ˆì´ê·¸ë ˆì´ì…˜ (ìë™ ì‹¤í–‰ë¨, í™•ì¸ìš©)
docker-compose -f docker-compose.dev.yml exec django python manage.py migrate

# 5. í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„±
docker-compose -f docker-compose.dev.yml exec django python manage.py create_test_users

# 6. ìƒ˜í”Œ ë°ì´í„° ìƒì„±
docker-compose -f docker-compose.dev.yml exec django python manage.py init_sample_data

# 7. DICOM ì—…ë¡œë“œ (ì„ íƒì‚¬í•­)
docker-compose -f docker-compose.dev.yml exec django python manage.py upload_sample_dicoms --dry-run

# ì™„ë£Œ!
```

**ì˜ˆìƒ ì‹œê°„**: 3-5ë¶„ (ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹œê°„ í¬í•¨)

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- [39_Docker_ì•„í‚¤í…ì²˜.md](39_Docker_ì•„í‚¤í…ì²˜.md) - Docker ì•„í‚¤í…ì²˜ ìƒì„¸
- [40_Docker_ê°œë°œ_ê°€ì´ë“œ.md](40_Docker_ê°œë°œ_ê°€ì´ë“œ.md) - Docker ê°œë°œ ì‹¤ìŠµ
- [REF_CLAUDE_ONBOARDING_QUICK.md](REF_CLAUDE_ONBOARDING_QUICK.md) - ë¹ ë¥¸ ì‹œì‘ ê°€ì´ë“œ

---

**ë¬¸ì„œ ë²„ì „**: 2.0 (docker-compose.dev.yml í†µí•©)
**ìµœì¢… ìˆ˜ì •**: 2025-12-30
**ì‘ì„±ì**: NeuroNova Development Team
