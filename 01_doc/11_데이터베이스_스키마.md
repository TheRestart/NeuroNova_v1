# CDSS ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

**ì‘ì„±ì¼**: 2025-12-19
**ë²„ì „**: 1.0
**DBMS**: MySQL 8.0
**ë¬¸ìì…‹**: utf8mb4
**Collation**: utf8mb4_unicode_ci

---

## ğŸ“‹ ëª©ì°¨

1. [ë°ì´í„°ë² ì´ìŠ¤ ê°œìš”](#1-ë°ì´í„°ë² ì´ìŠ¤-ê°œìš”)
2. [ERD (Entity Relationship Diagram)](#2-erd-entity-relationship-diagram)
3. [í…Œì´ë¸” ì •ì˜](#3-í…Œì´ë¸”-ì •ì˜)
   - [UC1 - ACCT (ì¸ì¦/ê¶Œí•œ)](#uc1---acct-ì¸ì¦ê¶Œí•œ)
   - [UC2 - EMR (ì „ìì˜ë¬´ê¸°ë¡)](#uc2---emr-ì „ìì˜ë¬´ê¸°ë¡)
   - [UC3 - OCS (ì²˜ë°©ì „ë‹¬)](#uc3---ocs-ì²˜ë°©ì „ë‹¬)
   - [UC4 - LIS (ì„ìƒë³‘ë¦¬)](#uc4---lis-ì„ìƒë³‘ë¦¬)
   - [UC5 - RIS (ì˜ìƒì˜í•™)](#uc5---ris-ì˜ìƒì˜í•™)
   - [UC6 - AI (AI ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜)](#uc6---ai-ai-ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜)
   - [UC7 - ALERT (ì•Œë¦¼)](#uc7---alert-ì•Œë¦¼)
   - [UC8 - FHIR (ì˜ë£Œì •ë³´ êµí™˜)](#uc8---fhir-ì˜ë£Œì •ë³´-êµí™˜)
   - [UC9 - AUDIT (ê°ì‚¬ ë¡œê·¸)](#uc9---audit-ê°ì‚¬-ë¡œê·¸)
4. [ì¸ë±ìŠ¤ ì „ëµ](#4-ì¸ë±ìŠ¤-ì „ëµ)
5. [ì™¸ë˜í‚¤ ê´€ê³„](#5-ì™¸ë˜í‚¤-ê´€ê³„)
6. [ì´ˆê¸° ë°ì´í„° (Fixtures)](#6-ì´ˆê¸°-ë°ì´í„°-fixtures)

---

## 1. ë°ì´í„°ë² ì´ìŠ¤ ê°œìš”

### ë°ì´í„°ë² ì´ìŠ¤ëª…
- **CDSS_DB**: ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤

### ì„¤ê³„ ì›ì¹™
1. **ì •ê·œí™”**: 3NF (ì œ3ì •ê·œí˜•) ì¤€ìˆ˜
2. **ëª…ëª… ê·œì¹™**: Snake Case (`table_name`, `column_name`)
3. **íƒ€ì„ìŠ¤íƒ¬í”„**: ëª¨ë“  í…Œì´ë¸”ì— `created_at`, `updated_at` í¬í•¨
4. **Soft Delete**: ì¤‘ìš” ë°ì´í„°ëŠ” `deleted_at` ì‚¬ìš© (ë¬¼ë¦¬ ì‚­ì œ ì§€ì–‘)
5. **UUID**: ì£¼ìš” ì—”í‹°í‹°ëŠ” UUID ê¸°ë³¸í‚¤ ì‚¬ìš© (ë³´ì•ˆ ê°•í™”)

### ë°ì´í„° íƒ€ì… ê·œì¹™
- **ID**: `CHAR(36)` (UUID) ë˜ëŠ” `VARCHAR(20)` (ì»¤ìŠ¤í…€ ID)
- **ë‚ ì§œ/ì‹œê°„**: `DATETIME(6)` (ë§ˆì´í¬ë¡œì´ˆ í¬í•¨)
- **ë¶€ìš¸**: `TINYINT(1)` (0/1)
- **JSON**: `JSON` (MySQL 8.0+)
- **í…ìŠ¤íŠ¸**: `VARCHAR(255)` (ì§§ì€ í…ìŠ¤íŠ¸), `TEXT` (ê¸´ í…ìŠ¤íŠ¸)

---

## 2. ERD (Entity Relationship Diagram)

### ì „ì²´ ERD (Mermaid)

```mermaid
erDiagram
    %% UC1 - ACCT (ì¸ì¦/ê¶Œí•œ)
    ACCT_USERS ||--o{ ACCT_USER_ROLES : has
    ACCT_ROLES ||--o{ ACCT_USER_ROLES : assigned_to
    ACCT_ROLES ||--o{ ACCT_ROLE_PERMS : has
    ACCT_PERMISSIONS ||--o{ ACCT_ROLE_PERMS : granted_to
    ACCT_USERS ||--o{ ACCT_REFRESH_TOKENS : owns
    ACCT_USERS ||--o{ ACCT_MFA_SECRETS : owns

    %% UC2 - EMR (ì „ìì˜ë¬´ê¸°ë¡)
    EMR_PATIENT_CACHE ||--o{ EMR_ENCOUNTERS : has
    ACCT_USERS ||--o{ EMR_ENCOUNTERS : performs

    %% UC3 - OCS (ì²˜ë°©ì „ë‹¬)
    EMR_PATIENT_CACHE ||--o{ OCS_ORDERS : receives
    EMR_ENCOUNTERS ||--o{ OCS_ORDERS : contains
    ACCT_USERS ||--o{ OCS_ORDERS : orders
    OCS_ORDERS ||--o{ OCS_ORDER_ITEMS : contains
    OCS_ORDER_ITEMS }o--|| OCS_MEDICATION_MASTER : references
    OCS_DIAGNOSIS_MASTER ||--o{ EMR_ENCOUNTERS : used_in
    LIS_LAB_TEST_MASTER ||--o{ LIS_TEST_ORDERS : used_in

    %% UC4 - LIS (ì„ìƒë³‘ë¦¬)
    EMR_PATIENT_CACHE ||--o{ LIS_TEST_ORDERS : receives
    EMR_ENCOUNTERS ||--o{ LIS_TEST_ORDERS : contains
    ACCT_USERS ||--o{ LIS_TEST_ORDERS : orders
    LIS_TEST_ORDERS ||--o{ LIS_TEST_RESULTS : produces

    %% UC5 - RIS (ì˜ìƒì˜í•™)
    EMR_PATIENT_CACHE ||--o{ RADIOLOGY_ORDERS : receives
    EMR_ENCOUNTERS ||--o{ RADIOLOGY_ORDERS : contains
    RADIOLOGY_ORDERS ||--o{ RADIOLOGY_STUDIES : results_in
    RADIOLOGY_STUDIES ||--o{ RADIOLOGY_REPORTS : has
    ACCT_USERS ||--o{ RADIOLOGY_REPORTS : writes

    %% UC6 - AI (AI ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜)
    RADIOLOGY_STUDIES ||--o{ AI_JOBS : analyzes
    AI_JOBS ||--o{ AI_RESULTS : produces
    AI_RESULTS ||--o{ AI_ARTIFACTS : contains
    ACCT_USERS ||--o{ AI_RESULTS : approves

    %% UC7 - ALERT (ì•Œë¦¼)
    ACCT_USERS ||--o{ TIMELINE_EVENTS : receives
    ACCT_USERS ||--o{ TIMELINE_NOTIFICATIONS : receives

    %% UC8 - FHIR (ì˜ë£Œì •ë³´ êµí™˜)
    EMR_PATIENT_CACHE ||--o{ FHIR_RESOURCE_MAP : maps_to
    FHIR_RESOURCE_MAP ||--o{ FHIR_SYNC_QUEUE : queues

    %% UC9 - AUDIT (ê°ì‚¬ ë¡œê·¸)
    ACCT_USERS ||--o{ AUDIT_LOGS : performs
    ACCT_USERS ||--o{ AUDIT_SECURITY_EVENTS : triggers

    %% í…Œì´ë¸” ì •ì˜
    ACCT_USERS {
        char(36) user_id PK
        varchar(50) username UK
        varchar(255) password_hash
        varchar(100) email UK
        varchar(50) employee_id UK
        varchar(100) department
        varchar(20) phone
        tinyint(1) is_active
        datetime(6) created_at
        datetime(6) updated_at
        datetime(6) last_login
    }

    ACCT_ROLES {
        varchar(20) role_key PK
        varchar(50) name
        text description
        tinyint(1) enabled
        datetime(6) created_at
    }

    ACCT_PERMISSIONS {
        varchar(50) perm_key PK
        varchar(100) name
        text description
        varchar(50) category
    }

    ACCT_USER_ROLES {
        char(36) mapping_id PK
        char(36) user_id FK
        varchar(20) role_key FK
        datetime(6) assigned_at
        char(36) assigned_by FK
    }

    ACCT_ROLE_PERMS {
        char(36) mapping_id PK
        varchar(20) role_key FK
        varchar(50) perm_key FK
    }

    ACCT_REFRESH_TOKENS {
        char(36) token_id PK
        char(36) user_id FK
        varchar(500) token_hash
        datetime(6) expires_at
        tinyint(1) is_revoked
        datetime(6) created_at
    }

    ACCT_MFA_SECRETS {
        char(36) secret_id PK
        char(36) user_id FK
        varchar(100) secret_encrypted
        tinyint(1) enabled
        datetime(6) created_at
    }

    EMR_PATIENT_CACHE {
        varchar(20) patient_id PK
        varchar(50) family_name
        varchar(50) given_name
        date birth_date
        varchar(10) gender
        varchar(20) phone
        varchar(100) email
        text address
        json emergency_contact
        json allergies
        varchar(5) blood_type
        varchar(100) openemr_patient_id UK
        datetime(6) last_synced_at
        datetime(6) created_at
        datetime(6) updated_at
    }

    EMR_ENCOUNTERS {
        varchar(20) encounter_id PK
        varchar(20) patient_id FK
        char(36) doctor_id FK
        varchar(20) encounter_type
        varchar(100) department
        text chief_complaint
        text diagnosis
        varchar(20) status
        datetime(6) encounter_date
        datetime(6) created_at
        datetime(6) updated_at
    }

    OCS_ORDERS {
        varchar(20) order_id PK
        varchar(20) patient_id FK
        varchar(20) encounter_id FK
        char(36) ordered_by FK
        varchar(50) order_type
        varchar(20) urgency
        varchar(20) status
        text notes
        datetime(6) ordered_at
        datetime(6) executed_at
        char(36) executed_by FK
    }

    OCS_ORDER_ITEMS {
        varchar(20) item_id PK
        varchar(20) order_id FK
        varchar(50) drug_code
        varchar(200) drug_name
        varchar(50) dosage
        varchar(50) frequency
        varchar(20) duration
        varchar(50) route
        text instructions
    }

    LIS_TEST_ORDERS {
        varchar(20) test_order_id PK
        varchar(20) patient_id FK
        varchar(20) encounter_id FK
        char(36) ordered_by FK
        varchar(50) test_type
        varchar(20) urgency
        varchar(20) status
        text notes
        datetime(6) ordered_at
        datetime(6) scheduled_at
    }

    LIS_TEST_RESULTS {
        varchar(20) result_id PK
        varchar(20) test_order_id FK
        varchar(50) test_code
        varchar(100) test_name
        json results_data
        tinyint(1) has_abnormal
        char(36) performed_by FK
        char(36) verified_by FK
        datetime(6) performed_at
        datetime(6) verified_at
    }

    RADIOLOGY_ORDERS {
        varchar(20) order_id PK
        varchar(20) patient_id FK
        varchar(20) encounter_id FK
        char(36) ordered_by FK
        varchar(20) modality_type
        varchar(100) body_part
        text clinical_info
        varchar(20) urgency
        tinyint(1) contrast
        varchar(20) status
        text notes
        datetime(6) ordered_at
        datetime(6) scheduled_at
    }

    RADIOLOGY_STUDIES {
        varchar(20) study_id PK
        varchar(20) order_id FK
        varchar(200) study_instance_uid UK
        varchar(20) patient_id FK
        varchar(20) modality_type
        varchar(100) body_part
        datetime(6) study_date
        int series_count
        int instance_count
        varchar(100) orthanc_study_id
        varchar(500) wado_url
        varchar(20) status
        datetime(6) created_at
    }

    RADIOLOGY_REPORTS {
        varchar(20) report_id PK
        varchar(20) study_id FK
        char(36) reported_by FK
        text findings
        text impression
        text recommendation
        varchar(20) status
        varchar(500) signature
        datetime(6) reported_at
        datetime(6) signed_at
    }

    AI_JOBS {
        varchar(20) job_id PK
        varchar(20) study_id FK
        varchar(50) analysis_type
        json parameters
        varchar(20) priority
        varchar(20) status
        int progress
        text error_message
        char(36) created_by FK
        datetime(6) created_at
        datetime(6) started_at
        datetime(6) completed_at
    }

    AI_RESULTS {
        varchar(20) result_id PK
        varchar(20) job_id FK
        varchar(20) study_id FK
        varchar(50) analysis_type
        json findings
        float confidence_score
        varchar(20) status
        char(36) approved_by FK
        text approval_comments
        datetime(6) completed_at
        datetime(6) approved_at
    }

    AI_ARTIFACTS {
        varchar(20) artifact_id PK
        varchar(20) result_id FK
        varchar(100) artifact_type
        varchar(500) s3_url
        bigint file_size_bytes
        varchar(100) mime_type
        datetime(6) created_at
    }

    TIMELINE_EVENTS {
        varchar(20) event_id PK
        varchar(20) patient_id FK
        varchar(50) event_type
        varchar(200) title
        text description
        json metadata
        datetime(6) event_timestamp
        datetime(6) created_at
    }

    TIMELINE_NOTIFICATIONS {
        varchar(20) notification_id PK
        char(36) user_id FK
        varchar(50) notification_type
        varchar(200) title
        text message
        varchar(20) severity
        tinyint(1) is_read
        json data
        datetime(6) created_at
        datetime(6) read_at
    }

    FHIR_RESOURCE_MAP {
        varchar(20) map_id PK
        varchar(50) resource_type
        varchar(100) cdss_id
        varchar(100) fhir_id
        varchar(500) fhir_server_url
        datetime(6) last_synced_at
        datetime(6) created_at
    }

    FHIR_SYNC_QUEUE {
        varchar(20) sync_job_id PK
        varchar(20) map_id FK
        varchar(50) operation
        varchar(20) status
        text error_message
        int retry_count
        datetime(6) queued_at
        datetime(6) processed_at
    }

    AUDIT_LOGS {
        varchar(20) log_id PK
        char(36) actor_user_id FK
        varchar(50) action
        varchar(50) resource_type
        varchar(100) resource_id
        json details
        varchar(45) ip_address
        text user_agent
        datetime(6) timestamp
    }

    AUDIT_SECURITY_EVENTS {
        varchar(20) event_id PK
        varchar(50) event_type
        varchar(20) severity
        varchar(50) username
        char(36) user_id FK
        varchar(45) ip_address
        text description
        json metadata
        tinyint(1) blocked
        datetime(6) timestamp
    }
```

---

## 3. í…Œì´ë¸” ì •ì˜

### UC1 - ACCT (ì¸ì¦/ê¶Œí•œ)

#### ACCT_USERS (ì‚¬ìš©ì)

**ì„¤ëª…**: ì‹œìŠ¤í…œ ì‚¬ìš©ì ì •ë³´

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE ACCT_USERS (
    user_id CHAR(36) PRIMARY KEY COMMENT 'UUID',
    username VARCHAR(50) NOT NULL UNIQUE COMMENT 'ì‚¬ìš©ìëª… (ë¡œê·¸ì¸ ID)',
    password_hash VARCHAR(255) NOT NULL COMMENT 'bcrypt í•´ì‹œ',
    email VARCHAR(100) UNIQUE COMMENT 'ì´ë©”ì¼',
    employee_id VARCHAR(50) UNIQUE COMMENT 'ì§ì› ë²ˆí˜¸',
    department VARCHAR(100) COMMENT 'ë¶€ì„œ',
    phone VARCHAR(20) COMMENT 'ì „í™”ë²ˆí˜¸',
    is_active TINYINT(1) DEFAULT 1 COMMENT 'í™œì„± ìƒíƒœ',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ',
    updated_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6) COMMENT 'ìˆ˜ì •ì¼ì‹œ',
    last_login DATETIME(6) COMMENT 'ë§ˆì§€ë§‰ ë¡œê·¸ì¸',
    INDEX idx_username (username),
    INDEX idx_employee_id (employee_id),
    INDEX idx_is_active (is_active)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ì‚¬ìš©ì';
```

---

#### ACCT_ROLES (ì—­í• )

**ì„¤ëª…**: 7ê°œ ì—­í•  ì •ì˜ (Admin, Doctor, RIB, Lab, Nurse, Patient, External)

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE ACCT_ROLES (
    role_key VARCHAR(20) PRIMARY KEY COMMENT 'ì—­í•  ì½”ë“œ (ADMIN, DOCTOR, RIB, LAB, NURSE, PATIENT, EXTERNAL)',
    name VARCHAR(50) NOT NULL COMMENT 'ì—­í• ëª…',
    description TEXT COMMENT 'ì„¤ëª…',
    enabled TINYINT(1) DEFAULT 1 COMMENT 'í™œì„± ìƒíƒœ',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ì—­í• ';
```

---

#### ACCT_PERMISSIONS (ê¶Œí•œ)

**ì„¤ëª…**: ê¶Œí•œ ì •ì˜ (patient.view, order.create ë“±)

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE ACCT_PERMISSIONS (
    perm_key VARCHAR(50) PRIMARY KEY COMMENT 'ê¶Œí•œ ì½”ë“œ (ì˜ˆ: patient.view)',
    name VARCHAR(100) NOT NULL COMMENT 'ê¶Œí•œëª…',
    description TEXT COMMENT 'ì„¤ëª…',
    category VARCHAR(50) COMMENT 'ì¹´í…Œê³ ë¦¬ (patient, order, report ë“±)',
    INDEX idx_category (category)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ê¶Œí•œ';
```

---

#### ACCT_USER_ROLES (ì‚¬ìš©ì-ì—­í•  ë§¤í•‘)

**ì„¤ëª…**: N:M ê´€ê³„ (ì‚¬ìš©ìëŠ” ì—¬ëŸ¬ ì—­í•  ê°€ì§ˆ ìˆ˜ ìˆìŒ)

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE ACCT_USER_ROLES (
    mapping_id CHAR(36) PRIMARY KEY COMMENT 'UUID',
    user_id CHAR(36) NOT NULL COMMENT 'ì‚¬ìš©ì ID',
    role_key VARCHAR(20) NOT NULL COMMENT 'ì—­í•  ì½”ë“œ',
    assigned_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'í• ë‹¹ì¼ì‹œ',
    assigned_by CHAR(36) COMMENT 'í• ë‹¹í•œ ì‚¬ìš©ì ID',
    FOREIGN KEY (user_id) REFERENCES ACCT_USERS(user_id) ON DELETE CASCADE,
    FOREIGN KEY (role_key) REFERENCES ACCT_ROLES(role_key) ON DELETE CASCADE,
    FOREIGN KEY (assigned_by) REFERENCES ACCT_USERS(user_id) ON DELETE SET NULL,
    UNIQUE KEY uk_user_role (user_id, role_key),
    INDEX idx_user_id (user_id),
    INDEX idx_role_key (role_key)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ì‚¬ìš©ì-ì—­í•  ë§¤í•‘';
```

---

#### ACCT_ROLE_PERMS (ì—­í• -ê¶Œí•œ ë§¤í•‘)

**ì„¤ëª…**: N:M ê´€ê³„ (ì—­í• ì€ ì—¬ëŸ¬ ê¶Œí•œ ê°€ì§ˆ ìˆ˜ ìˆìŒ)

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE ACCT_ROLE_PERMS (
    mapping_id CHAR(36) PRIMARY KEY COMMENT 'UUID',
    role_key VARCHAR(20) NOT NULL COMMENT 'ì—­í•  ì½”ë“œ',
    perm_key VARCHAR(50) NOT NULL COMMENT 'ê¶Œí•œ ì½”ë“œ',
    FOREIGN KEY (role_key) REFERENCES ACCT_ROLES(role_key) ON DELETE CASCADE,
    FOREIGN KEY (perm_key) REFERENCES ACCT_PERMISSIONS(perm_key) ON DELETE CASCADE,
    UNIQUE KEY uk_role_perm (role_key, perm_key),
    INDEX idx_role_key (role_key),
    INDEX idx_perm_key (perm_key)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ì—­í• -ê¶Œí•œ ë§¤í•‘';
```

---

#### ACCT_REFRESH_TOKENS (ë¦¬í”„ë ˆì‹œ í† í°)

**ì„¤ëª…**: JWT Refresh Token ì €ì¥

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE ACCT_REFRESH_TOKENS (
    token_id CHAR(36) PRIMARY KEY COMMENT 'UUID',
    user_id CHAR(36) NOT NULL COMMENT 'ì‚¬ìš©ì ID',
    token_hash VARCHAR(500) NOT NULL COMMENT 'SHA-256 í•´ì‹œ',
    expires_at DATETIME(6) NOT NULL COMMENT 'ë§Œë£Œì¼ì‹œ',
    is_revoked TINYINT(1) DEFAULT 0 COMMENT 'ë¬´íš¨í™” ì—¬ë¶€',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ',
    FOREIGN KEY (user_id) REFERENCES ACCT_USERS(user_id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_expires_at (expires_at),
    INDEX idx_is_revoked (is_revoked)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ë¦¬í”„ë ˆì‹œ í† í°';
```

---

#### ACCT_MFA_SECRETS (MFA ì‹œí¬ë¦¿)

**ì„¤ëª…**: TOTP MFA ì‹œí¬ë¦¿ ì €ì¥

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE ACCT_MFA_SECRETS (
    secret_id CHAR(36) PRIMARY KEY COMMENT 'UUID',
    user_id CHAR(36) NOT NULL UNIQUE COMMENT 'ì‚¬ìš©ì ID',
    secret_encrypted VARCHAR(100) NOT NULL COMMENT 'AES-256 ì•”í˜¸í™”ëœ TOTP ì‹œí¬ë¦¿',
    enabled TINYINT(1) DEFAULT 1 COMMENT 'MFA í™œì„±í™” ì—¬ë¶€',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ',
    FOREIGN KEY (user_id) REFERENCES ACCT_USERS(user_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='MFA ì‹œí¬ë¦¿';
```

---

### UC2 - EMR (ì „ìì˜ë¬´ê¸°ë¡)

#### EMR_PATIENT_CACHE (í™˜ì ìºì‹œ)

**ì„¤ëª…**: OpenEMRì—ì„œ ë™ê¸°í™”í•œ í™˜ì ì •ë³´

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE EMR_PATIENT_CACHE (
    patient_id VARCHAR(20) PRIMARY KEY COMMENT 'í™˜ì ID (P-2024-001234)',
    family_name VARCHAR(50) NOT NULL COMMENT 'ì„±',
    given_name VARCHAR(50) NOT NULL COMMENT 'ì´ë¦„',
    birth_date DATE NOT NULL COMMENT 'ìƒë…„ì›”ì¼',
    gender VARCHAR(10) NOT NULL COMMENT 'ì„±ë³„ (male, female, other)',
    phone VARCHAR(20) COMMENT 'ì „í™”ë²ˆí˜¸',
    email VARCHAR(100) COMMENT 'ì´ë©”ì¼',
    address TEXT COMMENT 'ì£¼ì†Œ',
    emergency_contact JSON COMMENT 'ë¹„ìƒì—°ë½ì²˜ {name, relationship, phone}',
    allergies JSON COMMENT 'ì•Œë ˆë¥´ê¸° ëª©ë¡',
    blood_type VARCHAR(5) COMMENT 'í˜ˆì•¡í˜• (A+, B+, AB+, O+, A-, B-, AB-, O-)',
    openemr_patient_id VARCHAR(100) UNIQUE COMMENT 'OpenEMR í™˜ì ID',
    last_synced_at DATETIME(6) COMMENT 'OpenEMR ë§ˆì§€ë§‰ ë™ê¸°í™” ì‹œê°„',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ',
    updated_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6) COMMENT 'ìˆ˜ì •ì¼ì‹œ',
    INDEX idx_name (family_name, given_name),
    INDEX idx_birth_date (birth_date),
    INDEX idx_openemr_id (openemr_patient_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='í™˜ì ìºì‹œ';
```

---

#### EMR_ENCOUNTERS (ì§„ë£Œ ê¸°ë¡)

**ì„¤ëª…**: ì§„ë£Œ ê¸°ë¡ (íƒ€ì„ë¼ì¸ìš©)

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE EMR_ENCOUNTERS (
    encounter_id VARCHAR(20) PRIMARY KEY COMMENT 'ì§„ë£Œ ID (E-2025-005678)',
    patient_id VARCHAR(20) NOT NULL COMMENT 'í™˜ì ID',
    doctor_id CHAR(36) NOT NULL COMMENT 'ë‹´ë‹¹ì˜ì‚¬ ID',
    encounter_type VARCHAR(20) NOT NULL COMMENT 'ì§„ë£Œ ìœ í˜• (ì™¸ë˜, ì…ì›, ì‘ê¸‰)',
    department VARCHAR(100) COMMENT 'ì§„ë£Œ ë¶€ì„œ',
    chief_complaint TEXT COMMENT 'ì£¼ í˜¸ì†Œ',
    diagnosis TEXT COMMENT 'ì§„ë‹¨ëª…',
    status VARCHAR(20) DEFAULT 'active' COMMENT 'ìƒíƒœ (active, completed, cancelled)',
    encounter_date DATETIME(6) NOT NULL COMMENT 'ì§„ë£Œ ì¼ì‹œ',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ',
    updated_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6) COMMENT 'ìˆ˜ì •ì¼ì‹œ',
    FOREIGN KEY (patient_id) REFERENCES EMR_PATIENT_CACHE(patient_id) ON DELETE CASCADE,
    FOREIGN KEY (doctor_id) REFERENCES ACCT_USERS(user_id) ON DELETE RESTRICT,
    INDEX idx_patient_id (patient_id),
    INDEX idx_doctor_id (doctor_id),
    INDEX idx_encounter_date (encounter_date),
    INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ì§„ë£Œ ê¸°ë¡';
```

---

### UC3 - OCS (ì²˜ë°©ì „ë‹¬)

#### OCS_ORDERS (ì²˜ë°© ì˜¤ë”)

**ì„¤ëª…**: ì²˜ë°© ì˜¤ë” (ì•½ë¬¼, ê²€ì‚¬, ì‹œìˆ  ë“±)

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE OCS_ORDERS (
    order_id VARCHAR(20) PRIMARY KEY COMMENT 'ì²˜ë°© ID (O-2025-009876)',
    patient_id VARCHAR(20) NOT NULL COMMENT 'í™˜ì ID',
    encounter_id VARCHAR(20) COMMENT 'ì§„ë£Œ ID',
    ordered_by CHAR(36) NOT NULL COMMENT 'ì²˜ë°© ì˜ì‚¬ ID',
    order_type VARCHAR(50) NOT NULL COMMENT 'ì²˜ë°© ìœ í˜• (medication, test, procedure)',
    urgency VARCHAR(20) DEFAULT 'routine' COMMENT 'ê¸´ê¸‰ë„ (stat, urgent, routine)',
    status VARCHAR(20) DEFAULT 'pending' COMMENT 'ìƒíƒœ (pending, executing, completed, cancelled)',
    notes TEXT COMMENT 'ë¹„ê³ ',
    ordered_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ì²˜ë°© ì¼ì‹œ',
    executed_at DATETIME(6) COMMENT 'ì‹¤í–‰ ì¼ì‹œ',
    executed_by CHAR(36) COMMENT 'ì‹¤í–‰ì ID',
    FOREIGN KEY (patient_id) REFERENCES EMR_PATIENT_CACHE(patient_id) ON DELETE CASCADE,
    FOREIGN KEY (encounter_id) REFERENCES EMR_ENCOUNTERS(encounter_id) ON DELETE SET NULL,
    FOREIGN KEY (ordered_by) REFERENCES ACCT_USERS(user_id) ON DELETE RESTRICT,
    FOREIGN KEY (executed_by) REFERENCES ACCT_USERS(user_id) ON DELETE SET NULL,
    INDEX idx_patient_id (patient_id),
    INDEX idx_ordered_by (ordered_by),
    INDEX idx_status (status),
    INDEX idx_ordered_at (ordered_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ì²˜ë°© ì˜¤ë”';
```

---

#### OCS_ORDER_ITEMS (ì²˜ë°© í•­ëª©)

**ì„¤ëª…**: ì²˜ë°© ìƒì„¸ í•­ëª© (ì•½ë¬¼ ì •ë³´)

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE OCS_ORDER_ITEMS (
    item_id VARCHAR(20) PRIMARY KEY COMMENT 'í•­ëª© ID (OI-001)',
    order_id VARCHAR(20) NOT NULL COMMENT 'ì²˜ë°© ID',
    drug_code VARCHAR(50) COMMENT 'ì•½í’ˆ ì½”ë“œ',
    drug_name VARCHAR(200) NOT NULL COMMENT 'ì•½í’ˆëª…',
    dosage VARCHAR(50) COMMENT 'ìš©ëŸ‰ (ì˜ˆ: 1ì •)',
    frequency VARCHAR(50) COMMENT 'íˆ¬ì•½ íšŸìˆ˜ (ì˜ˆ: 1ì¼ 1íšŒ)',
    duration VARCHAR(20) COMMENT 'íˆ¬ì•½ ê¸°ê°„ (ì˜ˆ: 7ì¼)',
    route VARCHAR(50) COMMENT 'íˆ¬ì•½ ê²½ë¡œ (ê²½êµ¬, ì •ë§¥ì£¼ì‚¬ ë“±)',
    instructions TEXT COMMENT 'ë³µì•½ ì§€ë„ (ì˜ˆ: ì‹í›„ 30ë¶„)',
    FOREIGN KEY (order_id) REFERENCES OCS_ORDERS(order_id) ON DELETE CASCADE,
    INDEX idx_order_id (order_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ì²˜ë°© í•­ëª©';

---

#### OCS_MEDICATION_MASTER (ì•½ë¬¼ ë§ˆìŠ¤í„°)

**ì„¤ëª…**: í‘œì¤€ ì•½ë¬¼ ì½”ë“œ ì •ë³´

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE ocs_medication_master (
    drug_code VARCHAR(50) PRIMARY KEY COMMENT 'ì•½ë¬¼ í‘œì¤€ ì½”ë“œ',
    drug_name VARCHAR(255) NOT NULL COMMENT 'ì•½ë¬¼ëª…',
    generic_name VARCHAR(255) COMMENT 'ì„±ë¶„ëª…',
    dosage_form VARCHAR(100) COMMENT 'ì œí˜•',
    strength VARCHAR(100) COMMENT 'í•¨ëŸ‰',
    unit VARCHAR(50) COMMENT 'ë‹¨ìœ„',
    manufacturer VARCHAR(255) COMMENT 'ì œì¡°ì‚¬',
    is_active TINYINT(1) DEFAULT 1,
    created_at DATETIME(6),
    updated_at DATETIME(6)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ì•½ë¬¼ ë§ˆìŠ¤í„°';
```

---

#### OCS_DIAGNOSIS_MASTER (ì§„ë‹¨ ë§ˆìŠ¤í„°)

**ì„¤ëª…**: í‘œì¤€ ì§ˆë³‘ ì½”ë“œ ì •ë³´ (ICD-10)

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE ocs_diagnosis_master (
    diag_code VARCHAR(20) PRIMARY KEY COMMENT 'ì§ˆë³‘ ì½”ë“œ',
    name_ko VARCHAR(255) NOT NULL COMMENT 'í•œê¸€ëª…',
    name_en VARCHAR(255) COMMENT 'ì˜ë¬¸ëª…',
    category VARCHAR(100) COMMENT 'ë¶„ë¥˜',
    is_active TINYINT(1) DEFAULT 1,
    created_at DATETIME(6),
    updated_at DATETIME(6)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ì§„ë‹¨ ë§ˆìŠ¤í„°';
```
```

---

### UC4 - LIS (ì„ìƒë³‘ë¦¬)

#### LIS_TEST_ORDERS (ê²€ì‚¬ ì˜¤ë”)

**ì„¤ëª…**: ì„ìƒë³‘ë¦¬ ê²€ì‚¬ ì˜¤ë”

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE LIS_TEST_ORDERS (
    test_order_id VARCHAR(20) PRIMARY KEY COMMENT 'ê²€ì‚¬ ì˜¤ë” ID (TO-2025-003456)',
    patient_id VARCHAR(20) NOT NULL COMMENT 'í™˜ì ID',
    encounter_id VARCHAR(20) COMMENT 'ì§„ë£Œ ID',
    ordered_by CHAR(36) NOT NULL COMMENT 'ì²˜ë°© ì˜ì‚¬ ID',
    test_type VARCHAR(50) NOT NULL COMMENT 'ê²€ì‚¬ ìœ í˜• (blood, urine, tissue)',
    urgency VARCHAR(20) DEFAULT 'routine' COMMENT 'ê¸´ê¸‰ë„',
    status VARCHAR(20) DEFAULT 'pending' COMMENT 'ìƒíƒœ',
    notes TEXT COMMENT 'ë¹„ê³  (ì˜ˆ: ê¸ˆì‹ ìƒíƒœ í™•ì¸)',
    ordered_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ì²˜ë°© ì¼ì‹œ',
    scheduled_at DATETIME(6) COMMENT 'ì˜ˆì • ì¼ì‹œ',
    FOREIGN KEY (patient_id) REFERENCES EMR_PATIENT_CACHE(patient_id) ON DELETE CASCADE,
    FOREIGN KEY (encounter_id) REFERENCES EMR_ENCOUNTERS(encounter_id) ON DELETE SET NULL,
    FOREIGN KEY (ordered_by) REFERENCES ACCT_USERS(user_id) ON DELETE RESTRICT,
    INDEX idx_patient_id (patient_id),
    INDEX idx_status (status),
    INDEX idx_ordered_at (ordered_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ê²€ì‚¬ ì˜¤ë”';
```

---

#### LIS_TEST_RESULTS (ê²€ì‚¬ ê²°ê³¼)

**ì„¤ëª…**: ê²€ì‚¬ ê²°ê³¼ ë°ì´í„°

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE LIS_TEST_RESULTS (
    result_id VARCHAR(20) PRIMARY KEY COMMENT 'ê²°ê³¼ ID (TR-2025-001234)',
    test_order_id VARCHAR(20) NOT NULL COMMENT 'ê²€ì‚¬ ì˜¤ë” ID',
    test_code VARCHAR(50) NOT NULL COMMENT 'ê²€ì‚¬ ì½”ë“œ (CBC, LFT ë“±)',
    test_name VARCHAR(100) NOT NULL COMMENT 'ê²€ì‚¬ëª…',
    results_data JSON NOT NULL COMMENT 'ê²°ê³¼ ë°ì´í„° {WBC: {value, unit, referenceRange, flag}}',
    has_abnormal TINYINT(1) DEFAULT 0 COMMENT 'ì´ìƒì¹˜ í¬í•¨ ì—¬ë¶€',
    performed_by CHAR(36) COMMENT 'ê²€ì‚¬ì ID',
    verified_by CHAR(36) COMMENT 'ê²€ì¦ì ID',
    performed_at DATETIME(6) COMMENT 'ê²€ì‚¬ ì¼ì‹œ',
    verified_at DATETIME(6) COMMENT 'ê²€ì¦ ì¼ì‹œ',
    FOREIGN KEY (test_order_id) REFERENCES LIS_TEST_ORDERS(test_order_id) ON DELETE CASCADE,
    FOREIGN KEY (performed_by) REFERENCES ACCT_USERS(user_id) ON DELETE SET NULL,
    FOREIGN KEY (verified_by) REFERENCES ACCT_USERS(user_id) ON DELETE SET NULL,
    INDEX idx_test_order_id (test_order_id),
    INDEX idx_has_abnormal (has_abnormal),
    INDEX idx_performed_at (performed_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ê²€ì‚¬ ê²°ê³¼';

---

#### LIS_LAB_TEST_MASTER (ê²€ì‚¬ ë§ˆìŠ¤í„°)

**ì„¤ëª…**: í‘œì¤€ ê²€ì‚¬ ì½”ë“œ ì •ë³´ (LOINC)

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE lis_lab_test_master (
    test_code VARCHAR(50) PRIMARY KEY COMMENT 'ê²€ì‚¬ ì½”ë“œ',
    test_name VARCHAR(255) NOT NULL COMMENT 'ê²€ì‚¬ëª…',
    sample_type VARCHAR(100) COMMENT 'ê²€ì²´ ìœ í˜•',
    method VARCHAR(100) COMMENT 'ê²€ì‚¬ ë°©ë²•',
    unit VARCHAR(50) COMMENT 'ë‹¨ìœ„',
    reference_range VARCHAR(255) COMMENT 'ì°¸ê³ ì¹˜',
    is_active TINYINT(1) DEFAULT 1,
    created_at DATETIME(6),
    updated_at DATETIME(6)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ê²€ì‚¬ ë§ˆìŠ¤í„°';
```
```

---

### UC5 - RIS (ì˜ìƒì˜í•™)

#### RADIOLOGY_ORDERS (ì˜ìƒ ì˜¤ë”)

**ì„¤ëª…**: ì˜ìƒ ê²€ì‚¬ ì˜¤ë”

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE RADIOLOGY_ORDERS (
    order_id VARCHAR(20) PRIMARY KEY COMMENT 'ì˜¤ë” ID (RO-2025-007890)',
    patient_id VARCHAR(20) NOT NULL COMMENT 'í™˜ì ID',
    encounter_id VARCHAR(20) COMMENT 'ì§„ë£Œ ID',
    ordered_by CHAR(36) NOT NULL COMMENT 'ì²˜ë°© ì˜ì‚¬ ID',
    modality_type VARCHAR(20) NOT NULL COMMENT 'ê²€ì‚¬ ìœ í˜• (MRI, CT, X-Ray)',
    body_part VARCHAR(100) NOT NULL COMMENT 'ì´¬ì˜ ë¶€ìœ„ (Brain, Chest ë“±)',
    clinical_info TEXT COMMENT 'ì„ìƒ ì •ë³´',
    urgency VARCHAR(20) DEFAULT 'routine' COMMENT 'ê¸´ê¸‰ë„',
    contrast TINYINT(1) DEFAULT 0 COMMENT 'ì¡°ì˜ì œ ì‚¬ìš© ì—¬ë¶€',
    status VARCHAR(20) DEFAULT 'scheduled' COMMENT 'ìƒíƒœ',
    notes TEXT COMMENT 'ë¹„ê³ ',
    ordered_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ì²˜ë°© ì¼ì‹œ',
    scheduled_at DATETIME(6) COMMENT 'ì˜ˆì • ì¼ì‹œ',
    FOREIGN KEY (patient_id) REFERENCES EMR_PATIENT_CACHE(patient_id) ON DELETE CASCADE,
    FOREIGN KEY (encounter_id) REFERENCES EMR_ENCOUNTERS(encounter_id) ON DELETE SET NULL,
    FOREIGN KEY (ordered_by) REFERENCES ACCT_USERS(user_id) ON DELETE RESTRICT,
    INDEX idx_patient_id (patient_id),
    INDEX idx_modality_type (modality_type),
    INDEX idx_status (status),
    INDEX idx_scheduled_at (scheduled_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ì˜ìƒ ì˜¤ë”';
```

---

#### RADIOLOGY_STUDIES (ì˜ìƒ ìŠ¤í„°ë””)

**ì„¤ëª…**: DICOM ìŠ¤í„°ë”” ì •ë³´ (Orthanc ì—°ë™)

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE RADIOLOGY_STUDIES (
    study_id VARCHAR(20) PRIMARY KEY COMMENT 'ìŠ¤í„°ë”” ID (ST-2025-001234)',
    order_id VARCHAR(20) COMMENT 'ì˜¤ë” ID',
    study_instance_uid VARCHAR(200) UNIQUE NOT NULL COMMENT 'DICOM Study Instance UID',
    patient_id VARCHAR(20) NOT NULL COMMENT 'í™˜ì ID',
    modality_type VARCHAR(20) NOT NULL COMMENT 'ê²€ì‚¬ ìœ í˜•',
    body_part VARCHAR(100) COMMENT 'ì´¬ì˜ ë¶€ìœ„',
    study_date DATETIME(6) NOT NULL COMMENT 'ì´¬ì˜ ì¼ì‹œ',
    series_count INT DEFAULT 0 COMMENT 'ì‹œë¦¬ì¦ˆ ìˆ˜',
    instance_count INT DEFAULT 0 COMMENT 'ì¸ìŠ¤í„´ìŠ¤(ì´ë¯¸ì§€) ìˆ˜',
    orthanc_study_id VARCHAR(100) UNIQUE COMMENT 'Orthanc Study ID (UUID)',
    wado_url VARCHAR(500) COMMENT 'WADO-RS URL',
    status VARCHAR(20) DEFAULT 'pending' COMMENT 'ìƒíƒœ (pending, completed, failed)',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ',
    FOREIGN KEY (order_id) REFERENCES RADIOLOGY_ORDERS(order_id) ON DELETE SET NULL,
    FOREIGN KEY (patient_id) REFERENCES EMR_PATIENT_CACHE(patient_id) ON DELETE CASCADE,
    INDEX idx_order_id (order_id),
    INDEX idx_patient_id (patient_id),
    INDEX idx_study_date (study_date),
    INDEX idx_study_instance_uid (study_instance_uid)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ì˜ìƒ ìŠ¤í„°ë””';
```

---

#### RADIOLOGY_REPORTS (íŒë…ë¬¸)

**ì„¤ëª…**: ì˜ìƒ íŒë…ë¬¸

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE RADIOLOGY_REPORTS (
    report_id VARCHAR(20) PRIMARY KEY COMMENT 'íŒë…ë¬¸ ID (RP-2025-005678)',
    study_id VARCHAR(20) NOT NULL COMMENT 'ìŠ¤í„°ë”” ID',
    reported_by CHAR(36) NOT NULL COMMENT 'íŒë… ì˜ì‚¬ ID',
    findings TEXT NOT NULL COMMENT 'ì†Œê²¬',
    impression TEXT NOT NULL COMMENT 'íŒë… ì˜ê²¬',
    recommendation TEXT COMMENT 'ê¶Œê³  ì‚¬í•­',
    status VARCHAR(20) DEFAULT 'preliminary' COMMENT 'ìƒíƒœ (preliminary, final)',
    signature VARCHAR(500) COMMENT 'ì „ìì„œëª…',
    reported_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'íŒë… ì¼ì‹œ',
    signed_at DATETIME(6) COMMENT 'ì„œëª… ì¼ì‹œ',
    FOREIGN KEY (study_id) REFERENCES RADIOLOGY_STUDIES(study_id) ON DELETE CASCADE,
    FOREIGN KEY (reported_by) REFERENCES ACCT_USERS(user_id) ON DELETE RESTRICT,
    INDEX idx_study_id (study_id),
    INDEX idx_reported_by (reported_by),
    INDEX idx_status (status),
    INDEX idx_reported_at (reported_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='íŒë…ë¬¸';
```

---

### UC6 - AI (AI ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜)

#### AI_JOBS (AI ì‘ì—…)

**ì„¤ëª…**: AI ë¶„ì„ ì‘ì—… í

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE AI_JOBS (
    job_id VARCHAR(20) PRIMARY KEY COMMENT 'AI ì‘ì—… ID (AI-2025-001234)',
    study_id VARCHAR(20) NOT NULL COMMENT 'ìŠ¤í„°ë”” ID',
    analysis_type VARCHAR(50) NOT NULL COMMENT 'ë¶„ì„ ìœ í˜• (mri_tumor_detection, omics_analysis)',
    parameters JSON COMMENT 'ë¶„ì„ íŒŒë¼ë¯¸í„° {model, confidence_threshold}',
    priority VARCHAR(20) DEFAULT 'normal' COMMENT 'ìš°ì„ ìˆœìœ„ (low, normal, high)',
    status VARCHAR(20) DEFAULT 'queued' COMMENT 'ìƒíƒœ (queued, processing, completed, failed)',
    progress INT DEFAULT 0 COMMENT 'ì§„í–‰ë¥  (0-100)',
    error_message TEXT COMMENT 'ì—ëŸ¬ ë©”ì‹œì§€',
    created_by CHAR(36) COMMENT 'ìš”ì²­ì ID',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ',
    started_at DATETIME(6) COMMENT 'ì‹œì‘ ì¼ì‹œ',
    completed_at DATETIME(6) COMMENT 'ì™„ë£Œ ì¼ì‹œ',
    FOREIGN KEY (study_id) REFERENCES RADIOLOGY_STUDIES(study_id) ON DELETE CASCADE,
    FOREIGN KEY (created_by) REFERENCES ACCT_USERS(user_id) ON DELETE SET NULL,
    INDEX idx_study_id (study_id),
    INDEX idx_status (status),
    INDEX idx_priority (priority),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='AI ì‘ì—…';
```

---

#### AI_RESULTS (AI ê²°ê³¼)

**ì„¤ëª…**: AI ë¶„ì„ ê²°ê³¼

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE AI_RESULTS (
    result_id VARCHAR(20) PRIMARY KEY COMMENT 'ê²°ê³¼ ID (AR-2025-001234)',
    job_id VARCHAR(20) NOT NULL COMMENT 'AI ì‘ì—… ID',
    study_id VARCHAR(20) NOT NULL COMMENT 'ìŠ¤í„°ë”” ID',
    analysis_type VARCHAR(50) NOT NULL COMMENT 'ë¶„ì„ ìœ í˜•',
    findings JSON NOT NULL COMMENT 'ë¶„ì„ ê²°ê³¼ {tumor_detected, location, volume, confidence}',
    confidence_score FLOAT COMMENT 'ì „ì²´ ì‹ ë¢°ë„ (0.0-1.0)',
    status VARCHAR(20) DEFAULT 'pending_review' COMMENT 'ìƒíƒœ (pending_review, approved, rejected)',
    approved_by CHAR(36) COMMENT 'ìŠ¹ì¸ì ID',
    approval_comments TEXT COMMENT 'ìŠ¹ì¸ ì½”ë©˜íŠ¸',
    completed_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ì™„ë£Œ ì¼ì‹œ',
    approved_at DATETIME(6) COMMENT 'ìŠ¹ì¸ ì¼ì‹œ',
    FOREIGN KEY (job_id) REFERENCES AI_JOBS(job_id) ON DELETE CASCADE,
    FOREIGN KEY (study_id) REFERENCES RADIOLOGY_STUDIES(study_id) ON DELETE CASCADE,
    FOREIGN KEY (approved_by) REFERENCES ACCT_USERS(user_id) ON DELETE SET NULL,
    INDEX idx_job_id (job_id),
    INDEX idx_study_id (study_id),
    INDEX idx_status (status),
    INDEX idx_completed_at (completed_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='AI ê²°ê³¼';
```

---

#### AI_ARTIFACTS (AI ì‚°ì¶œë¬¼)

**ì„¤ëª…**: AI ë¶„ì„ ì‚°ì¶œë¬¼ (ì„¸ê·¸ë©˜í…Œì´ì…˜ ë§ˆìŠ¤í¬, íˆíŠ¸ë§µ ë“±)

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE AI_ARTIFACTS (
    artifact_id VARCHAR(20) PRIMARY KEY COMMENT 'ì‚°ì¶œë¬¼ ID (AA-001)',
    result_id VARCHAR(20) NOT NULL COMMENT 'AI ê²°ê³¼ ID',
    artifact_type VARCHAR(100) NOT NULL COMMENT 'ì‚°ì¶œë¬¼ ìœ í˜• (segmentation_mask, heatmap, report_pdf)',
    s3_url VARCHAR(500) NOT NULL COMMENT 'MinIO S3 URL',
    file_size_bytes BIGINT COMMENT 'íŒŒì¼ í¬ê¸° (ë°”ì´íŠ¸)',
    mime_type VARCHAR(100) COMMENT 'MIME íƒ€ì…',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ',
    FOREIGN KEY (result_id) REFERENCES AI_RESULTS(result_id) ON DELETE CASCADE,
    INDEX idx_result_id (result_id),
    INDEX idx_artifact_type (artifact_type)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='AI ì‚°ì¶œë¬¼';
```

---

### UC7 - ALERT (ì•Œë¦¼)

#### TIMELINE_EVENTS (íƒ€ì„ë¼ì¸ ì´ë²¤íŠ¸)

**ì„¤ëª…**: í™˜ìë³„ íƒ€ì„ë¼ì¸ ì´ë²¤íŠ¸

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE TIMELINE_EVENTS (
    event_id VARCHAR(20) PRIMARY KEY COMMENT 'ì´ë²¤íŠ¸ ID (TE-2025-001234)',
    patient_id VARCHAR(20) NOT NULL COMMENT 'í™˜ì ID',
    event_type VARCHAR(50) NOT NULL COMMENT 'ì´ë²¤íŠ¸ ìœ í˜• (encounter, order, test, imaging, ai)',
    title VARCHAR(200) NOT NULL COMMENT 'ì œëª©',
    description TEXT COMMENT 'ì„¤ëª…',
    metadata JSON COMMENT 'ë©”íƒ€ë°ì´í„° {orderId, reportId ë“±}',
    event_timestamp DATETIME(6) NOT NULL COMMENT 'ì´ë²¤íŠ¸ ë°œìƒ ì¼ì‹œ',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ',
    FOREIGN KEY (patient_id) REFERENCES EMR_PATIENT_CACHE(patient_id) ON DELETE CASCADE,
    INDEX idx_patient_id (patient_id),
    INDEX idx_event_type (event_type),
    INDEX idx_event_timestamp (event_timestamp)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='íƒ€ì„ë¼ì¸ ì´ë²¤íŠ¸';
```

---

#### TIMELINE_NOTIFICATIONS (ì‚¬ìš©ì ì•Œë¦¼)

**ì„¤ëª…**: ì‚¬ìš©ìë³„ ì•Œë¦¼

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE TIMELINE_NOTIFICATIONS (
    notification_id VARCHAR(20) PRIMARY KEY COMMENT 'ì•Œë¦¼ ID (AL-2025-001234)',
    user_id CHAR(36) NOT NULL COMMENT 'ì‚¬ìš©ì ID',
    notification_type VARCHAR(50) NOT NULL COMMENT 'ì•Œë¦¼ ìœ í˜• (order, result, ai, system)',
    title VARCHAR(200) NOT NULL COMMENT 'ì œëª©',
    message TEXT NOT NULL COMMENT 'ë©”ì‹œì§€',
    severity VARCHAR(20) DEFAULT 'info' COMMENT 'ì‹¬ê°ë„ (info, warning, error, critical)',
    is_read TINYINT(1) DEFAULT 0 COMMENT 'ì½ìŒ ì—¬ë¶€',
    data JSON COMMENT 'ê´€ë ¨ ë°ì´í„° {resultId, patientId ë“±}',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ',
    read_at DATETIME(6) COMMENT 'ì½ì€ ì¼ì‹œ',
    FOREIGN KEY (user_id) REFERENCES ACCT_USERS(user_id) ON DELETE CASCADE,
    INDEX idx_user_id (user_id),
    INDEX idx_is_read (is_read),
    INDEX idx_severity (severity),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ì‚¬ìš©ì ì•Œë¦¼';
```

---

### UC8 - FHIR (ì˜ë£Œì •ë³´ êµí™˜)

#### FHIR_RESOURCE_MAP (FHIR ë¦¬ì†ŒìŠ¤ ë§¤í•‘)

**ì„¤ëª…**: CDSS ID â†” FHIR ID ë§¤í•‘

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE FHIR_RESOURCE_MAP (
    map_id VARCHAR(20) PRIMARY KEY COMMENT 'ë§¤í•‘ ID (FM-001)',
    resource_type VARCHAR(50) NOT NULL COMMENT 'FHIR ë¦¬ì†ŒìŠ¤ íƒ€ì… (Patient, Observation ë“±)',
    cdss_id VARCHAR(100) NOT NULL COMMENT 'CDSS ë¦¬ì†ŒìŠ¤ ID',
    fhir_id VARCHAR(100) NOT NULL COMMENT 'FHIR ë¦¬ì†ŒìŠ¤ ID',
    fhir_server_url VARCHAR(500) COMMENT 'HAPI FHIR ì„œë²„ URL',
    last_synced_at DATETIME(6) COMMENT 'ë§ˆì§€ë§‰ ë™ê¸°í™” ì‹œê°„',
    created_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ìƒì„±ì¼ì‹œ',
    UNIQUE KEY uk_cdss_resource (resource_type, cdss_id),
    INDEX idx_resource_type (resource_type),
    INDEX idx_cdss_id (cdss_id),
    INDEX idx_fhir_id (fhir_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='FHIR ë¦¬ì†ŒìŠ¤ ë§¤í•‘';
```

---

#### FHIR_SYNC_QUEUE (FHIR ë™ê¸°í™” í)

**ì„¤ëª…**: FHIR ë™ê¸°í™” ì‘ì—… í

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE FHIR_SYNC_QUEUE (
    sync_job_id VARCHAR(20) PRIMARY KEY COMMENT 'ë™ê¸°í™” ì‘ì—… ID (FS-2025-001234)',
    map_id VARCHAR(20) NOT NULL COMMENT 'ë§¤í•‘ ID',
    operation VARCHAR(20) NOT NULL COMMENT 'ì‘ì—… ìœ í˜• (create, update, delete)',
    status VARCHAR(20) DEFAULT 'queued' COMMENT 'ìƒíƒœ (queued, processing, completed, failed)',
    error_message TEXT COMMENT 'ì—ëŸ¬ ë©”ì‹œì§€',
    retry_count INT DEFAULT 0 COMMENT 'ì¬ì‹œë„ íšŸìˆ˜',
    queued_at DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'í ë“±ë¡ ì¼ì‹œ',
    processed_at DATETIME(6) COMMENT 'ì²˜ë¦¬ ì™„ë£Œ ì¼ì‹œ',
    FOREIGN KEY (map_id) REFERENCES FHIR_RESOURCE_MAP(map_id) ON DELETE CASCADE,
    INDEX idx_map_id (map_id),
    INDEX idx_status (status),
    INDEX idx_queued_at (queued_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='FHIR ë™ê¸°í™” í';
```

---

### UC9 - AUDIT (ê°ì‚¬ ë¡œê·¸)

#### AUDIT_LOGS (ê°ì‚¬ ë¡œê·¸)

**ì„¤ëª…**: ì‚¬ìš©ì í™œë™ ê°ì‚¬ ë¡œê·¸

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE AUDIT_LOGS (
    log_id VARCHAR(20) PRIMARY KEY COMMENT 'ë¡œê·¸ ID (AUDIT-2025-001234)',
    actor_user_id CHAR(36) COMMENT 'í–‰ìœ„ì ì‚¬ìš©ì ID',
    action VARCHAR(50) NOT NULL COMMENT 'ì•¡ì…˜ (login, create, update, delete, view)',
    resource_type VARCHAR(50) COMMENT 'ë¦¬ì†ŒìŠ¤ íƒ€ì… (patient, order, report)',
    resource_id VARCHAR(100) COMMENT 'ë¦¬ì†ŒìŠ¤ ID',
    details JSON COMMENT 'ìƒì„¸ ì •ë³´ {field, oldValue, newValue}',
    ip_address VARCHAR(45) COMMENT 'IP ì£¼ì†Œ (IPv6 ì§€ì›)',
    user_agent TEXT COMMENT 'User Agent',
    timestamp DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ì¼ì‹œ',
    FOREIGN KEY (actor_user_id) REFERENCES ACCT_USERS(user_id) ON DELETE SET NULL,
    INDEX idx_actor_user_id (actor_user_id),
    INDEX idx_action (action),
    INDEX idx_resource_type (resource_type),
    INDEX idx_timestamp (timestamp)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ê°ì‚¬ ë¡œê·¸';
```

---

#### AUDIT_SECURITY_EVENTS (ë³´ì•ˆ ì´ë²¤íŠ¸)

**ì„¤ëª…**: ë³´ì•ˆ ê´€ë ¨ ì´ë²¤íŠ¸ ë¡œê·¸

**í…Œì´ë¸” ìƒì„± SQL**
```sql
CREATE TABLE AUDIT_SECURITY_EVENTS (
    event_id VARCHAR(20) PRIMARY KEY COMMENT 'ì´ë²¤íŠ¸ ID (SE-2025-001234)',
    event_type VARCHAR(50) NOT NULL COMMENT 'ì´ë²¤íŠ¸ ìœ í˜• (failed_login, unauthorized_access, data_breach)',
    severity VARCHAR(20) NOT NULL COMMENT 'ì‹¬ê°ë„ (low, medium, high, critical)',
    username VARCHAR(50) COMMENT 'ì‚¬ìš©ìëª… (ì‹œë„í•œ ì‚¬ìš©ì)',
    user_id CHAR(36) COMMENT 'ì‚¬ìš©ì ID (ì¡´ì¬í•˜ëŠ” ê²½ìš°)',
    ip_address VARCHAR(45) NOT NULL COMMENT 'IP ì£¼ì†Œ',
    description TEXT COMMENT 'ì„¤ëª…',
    metadata JSON COMMENT 'ë©”íƒ€ë°ì´í„° {failedAttempts, resource ë“±}',
    blocked TINYINT(1) DEFAULT 0 COMMENT 'ì°¨ë‹¨ ì—¬ë¶€',
    timestamp DATETIME(6) DEFAULT CURRENT_TIMESTAMP(6) COMMENT 'ì¼ì‹œ',
    FOREIGN KEY (user_id) REFERENCES ACCT_USERS(user_id) ON DELETE SET NULL,
    INDEX idx_event_type (event_type),
    INDEX idx_severity (severity),
    INDEX idx_ip_address (ip_address),
    INDEX idx_timestamp (timestamp)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ë³´ì•ˆ ì´ë²¤íŠ¸';
```

---

## 4. ì¸ë±ìŠ¤ ì „ëµ

### ì¸ë±ì‹± ì›ì¹™
1. **WHERE ì ˆì— ìì£¼ ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼**: ì¸ë±ìŠ¤ í•„ìˆ˜
2. **JOIN í‚¤**: ì™¸ë˜í‚¤ì—ëŠ” ìë™ ì¸ë±ìŠ¤
3. **ORDER BY, GROUP BY ì»¬ëŸ¼**: ì¸ë±ìŠ¤ ê³ ë ¤
4. **ë³µí•© ì¸ë±ìŠ¤**: ì„ íƒë„ ë†’ì€ ì»¬ëŸ¼ì„ ì•ì— ë°°ì¹˜

### ì£¼ìš” ì¸ë±ìŠ¤ ëª©ë¡

```sql
-- í™˜ì ê²€ìƒ‰ ì„±ëŠ¥ í–¥ìƒ
CREATE INDEX idx_patient_name ON EMR_PATIENT_CACHE(family_name, given_name);

-- ì§„ë£Œ ê¸°ë¡ ì¡°íšŒ ì„±ëŠ¥ í–¥ìƒ
CREATE INDEX idx_encounter_patient_date ON EMR_ENCOUNTERS(patient_id, encounter_date DESC);

-- ì²˜ë°© ì¡°íšŒ ì„±ëŠ¥ í–¥ìƒ
CREATE INDEX idx_order_status_date ON OCS_ORDERS(status, ordered_at DESC);

-- AI ì‘ì—… í ì„±ëŠ¥ í–¥ìƒ
CREATE INDEX idx_ai_job_status_priority ON AI_JOBS(status, priority DESC, created_at);

-- ê°ì‚¬ ë¡œê·¸ ê²€ìƒ‰ ì„±ëŠ¥ í–¥ìƒ
CREATE INDEX idx_audit_user_action_time ON AUDIT_LOGS(actor_user_id, action, timestamp DESC);
```

---

## 5. ì™¸ë˜í‚¤ ê´€ê³„

### ì£¼ìš” ê´€ê³„ ì •ì˜

1. **ACCT_USERS â†’ ACCT_USER_ROLES â†’ ACCT_ROLES**
   - ì‚¬ìš©ìëŠ” ì—¬ëŸ¬ ì—­í•  ê°€ì§ˆ ìˆ˜ ìˆìŒ (N:M)

2. **ACCT_ROLES â†’ ACCT_ROLE_PERMS â†’ ACCT_PERMISSIONS**
   - ì—­í• ì€ ì—¬ëŸ¬ ê¶Œí•œ ê°€ì§ˆ ìˆ˜ ìˆìŒ (N:M)

3. **EMR_PATIENT_CACHE â†’ EMR_ENCOUNTERS**
   - í™˜ìëŠ” ì—¬ëŸ¬ ì§„ë£Œ ê¸°ë¡ ê°€ì§ (1:N)

4. **EMR_ENCOUNTERS â†’ OCS_ORDERS, LIS_TEST_ORDERS, RADIOLOGY_ORDERS**
   - ì§„ë£ŒëŠ” ì—¬ëŸ¬ ì²˜ë°©/ê²€ì‚¬ ì˜¤ë” í¬í•¨ (1:N)

5. **RADIOLOGY_STUDIES â†’ AI_JOBS â†’ AI_RESULTS**
   - ì˜ìƒ ìŠ¤í„°ë””ëŠ” ì—¬ëŸ¬ AI ë¶„ì„ ì‘ì—… ê°€ì§ (1:N)

### CASCADE ì •ì±…

| ê´€ê³„ | ON DELETE | ON UPDATE |
|---|---|---|
| ACCT_USERS â†’ ACCT_USER_ROLES | CASCADE | CASCADE |
| EMR_PATIENT_CACHE â†’ EMR_ENCOUNTERS | CASCADE | CASCADE |
| OCS_ORDERS â†’ OCS_ORDER_ITEMS | CASCADE | CASCADE |
| RADIOLOGY_STUDIES â†’ AI_JOBS | CASCADE | CASCADE |
| ACCT_USERS â†’ AUDIT_LOGS | SET NULL | CASCADE |

---

## 6. ì´ˆê¸° ë°ì´í„° (Fixtures)

### 6.1 ì—­í•  ì´ˆê¸° ë°ì´í„°

**SQL**
```sql
INSERT INTO ACCT_ROLES (role_key, name, description, enabled) VALUES
('ADMIN', 'ì‹œìŠ¤í…œ ê´€ë¦¬ì', 'ì‹œìŠ¤í…œ ì „ì²´ ê´€ë¦¬ ë° ì„¤ì •', 1),
('DOCTOR', 'ì‹ ê²½ì™¸ê³¼ ì˜ì‚¬', 'í™˜ì ì§„ë£Œ ë° AI ë¶„ì„ ê²°ê³¼ í™•ì •', 1),
('RIB', 'ë°©ì‚¬ì„ ê³¼', 'ì˜ë£Œ ì˜ìƒ ì—…ë¡œë“œ ë° ê´€ë¦¬', 1),
('LAB', 'ê²€ì‚¬ì‹¤', 'ê²€ì‚¬ ë°ì´í„° ì…ë ¥ ë° ê´€ë¦¬', 1),
('NURSE', 'ê°„í˜¸ì‚¬', 'ë°”ì´íƒˆ ì¸¡ì • ë° ê°„í˜¸ ê¸°ë¡', 1),
('PATIENT', 'ì¼ë°˜ í™˜ì', 'ë³¸ì¸ ì§„ë£Œ ë‚´ì—­ ì¡°íšŒ ë° ì˜ˆì•½', 1),
('EXTERNAL', 'ì™¸ë¶€ ê¸°ê´€', 'FHIR API ì—°ë™ìš© M2M ê³„ì •', 1);
```

### 6.2 ê¶Œí•œ ì´ˆê¸° ë°ì´í„°

**SQL**
```sql
INSERT INTO ACCT_PERMISSIONS (perm_key, name, description, category) VALUES
('patient.view', 'í™˜ì ì¡°íšŒ', 'í™˜ì ì •ë³´ ì¡°íšŒ', 'patient'),
('patient.edit', 'í™˜ì ìˆ˜ì •', 'í™˜ì ì •ë³´ ìˆ˜ì •', 'patient'),
('patient.view_self', 'ë³¸ì¸ ì¡°íšŒ', 'ë³¸ì¸ ì •ë³´ë§Œ ì¡°íšŒ (Patient ì—­í• )', 'patient'),
('order.create', 'ì²˜ë°© ìƒì„±', 'ì²˜ë°© ì˜¤ë” ìƒì„±', 'order'),
('order.view', 'ì²˜ë°© ì¡°íšŒ', 'ì²˜ë°© ì˜¤ë” ì¡°íšŒ', 'order'),
('order.edit', 'ì²˜ë°© ìˆ˜ì •', 'ì²˜ë°© ì˜¤ë” ìˆ˜ì •', 'order'),
('report.sign', 'íŒë…ë¬¸ ì„œëª…', 'íŒë…ë¬¸ ì „ìì„œëª…', 'report'),
('ai_result.view', 'AI ê²°ê³¼ ì¡°íšŒ', 'AI ë¶„ì„ ê²°ê³¼ ì¡°íšŒ', 'ai'),
('ai_result.approve', 'AI ê²°ê³¼ ìŠ¹ì¸', 'AI ë¶„ì„ ê²°ê³¼ ìŠ¹ì¸', 'ai'),
('dicom.upload', 'DICOM ì—…ë¡œë“œ', 'DICOM ì˜ìƒ ì—…ë¡œë“œ', 'dicom'),
('dicom.view', 'DICOM ì¡°íšŒ', 'DICOM ì˜ìƒ ì¡°íšŒ', 'dicom'),
('fhir.read', 'FHIR ì½ê¸°', 'FHIR ë¦¬ì†ŒìŠ¤ ì½ê¸°', 'fhir'),
('fhir.write', 'FHIR ì“°ê¸°', 'FHIR ë¦¬ì†ŒìŠ¤ ì“°ê¸°', 'fhir');
```

### 6.3 ì—­í• -ê¶Œí•œ ë§¤í•‘ ì´ˆê¸° ë°ì´í„°

**SQL**
```sql
-- Doctor ì—­í•  ê¶Œí•œ
INSERT INTO ACCT_ROLE_PERMS (mapping_id, role_key, perm_key) VALUES
(UUID(), 'DOCTOR', 'patient.view'),
(UUID(), 'DOCTOR', 'patient.edit'),
(UUID(), 'DOCTOR', 'order.create'),
(UUID(), 'DOCTOR', 'order.view'),
(UUID(), 'DOCTOR', 'order.edit'),
(UUID(), 'DOCTOR', 'report.sign'),
(UUID(), 'DOCTOR', 'ai_result.view'),
(UUID(), 'DOCTOR', 'ai_result.approve');

-- RIB ì—­í•  ê¶Œí•œ
INSERT INTO ACCT_ROLE_PERMS (mapping_id, role_key, perm_key) VALUES
(UUID(), 'RIB', 'dicom.upload'),
(UUID(), 'RIB', 'dicom.view');

-- Patient ì—­í•  ê¶Œí•œ
INSERT INTO ACCT_ROLE_PERMS (mapping_id, role_key, perm_key) VALUES
(UUID(), 'PATIENT', 'patient.view_self');

-- External ì—­í•  ê¶Œí•œ
INSERT INTO ACCT_ROLE_PERMS (mapping_id, role_key, perm_key) VALUES
(UUID(), 'EXTERNAL', 'fhir.read'),
(UUID(), 'EXTERNAL', 'fhir.write');
```

---

**Last Updated**: 2025-12-19
**Version**: 1.0
**Author**: Claude AI
