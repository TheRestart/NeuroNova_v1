# CDSS 프로젝트 수정 지침서

**목적**: 사용자가 Claude AI에게 효과적으로 수정 요청을 전달하기 위한 가이드
**대상**: 프로젝트 관리자, 개발 리더, QA 팀

---

## 📋 수정 요청 기본 원칙

### 1. 명확한 요청 작성
- ❌ 나쁜 예: "로그인이 안돼요"
- ✅ 좋은 예: "Doctor 역할로 로그인 시 403 에러가 발생합니다. 로그 확인 결과 Token 인증이 실패하는 것으로 보입니다."

### 2. 컨텍스트 제공
- 어떤 UC 모듈인지 명시 (UC1, UC2, ...)
- 어떤 역할에서 발생하는지 명시 (Admin, Doctor, Patient, ...)
- Frontend인지 Backend인지 명시
- 재현 방법 제공

### 3. 우선순위 표시
- **P0 (긴급)**: 시스템 중단, 보안 취약점
- **P1 (높음)**: 핵심 기능 버그
- **P2 (중간)**: 부가 기능 버그, 개선 사항
- **P3 (낮음)**: UI 개선, 코드 정리

---













## 🔧 수정 요청 템플릿

### 템플릿 1: 버그 수정 요청

```markdown
## [버그] 제목을 한 줄로 요약

**우선순위**: P1 (높음)
**모듈**: UC1 (ACCT)
**역할**: Doctor
**환경**: Backend (Django)

### 문제 상황
Doctor 역할로 로그인 시도 시 아래 에러 발생:
```
HTTP 403 Forbidden
{"detail": "Authentication credentials were not provided."}
```

### 재현 방법
1. `http://localhost:3000/login` 접속
2. 아이디: `doctor1`, 비밀번호: `doctor123` 입력
3. 로그인 버튼 클릭
4. 403 에러 발생

### 예상 원인
- React에서 API 요청 시 Authorization 헤더가 누락된 것으로 추정
- `src/api/axios.js`의 인터셉터 설정 문제 가능성

### 기대 결과
Doctor 역할로 로그인 성공 후 `/dashboard`로 리다이렉트

### 추가 정보
- 브라우저: Chrome 120
- 에러 로그: (첨부 또는 복사)
```

**Claude에게 요청 시**:
```
[04_수정_지침서.md]의 [템플릿 1: 버그 수정 요청]을 참고해서
UC1의 Doctor 로그인 403 에러를 수정해줘.

문제: Doctor 역할로 로그인 시 403 에러 발생
재현: doctor1 / doctor123 입력 시 Authorization 헤더 누락으로 추정
파일: src/api/axios.js의 인터셉터 설정 확인 필요
```

---



















### 템플릿 2: 기능 추가 요청

```markdown
## [기능] 제목을 한 줄로 요약

**우선순위**: P2 (중간)
**모듈**: UC7 (ALERT)
**역할**: 전체 (All)
**환경**: Frontend (React)

### 요청 내용
알림 목록에서 읽지 않은 알림 개수를 헤더에 표시하는 배지 추가

### 상세 설명
- 현재: 알림 목록은 `/dashboard`에서 조회 가능하지만, 읽지 않은 알림 개수를 알 수 없음
- 요구사항:
  1. 헤더 우측 상단에 벨 아이콘 추가
  2. 읽지 않은 알림이 있을 경우 빨간색 배지로 개수 표시 (예: 🔔 3)
  3. 벨 아이콘 클릭 시 알림 목록 드롭다운 표시

### 참고 자료
- Material-UI Badge 컴포넌트 사용 가능: https://mui.com/material-ui/react-badge/
- Backend API: `GET /api/alert/?is_read=false` (이미 구현됨)

### 기대 결과
- 헤더에 벨 아이콘 + 배지 표시
- 클릭 시 최근 알림 5개 드롭다운으로 표시
```

**Claude에게 요청 시**:
```
[04_수정_지침서.md]의 [템플릿 2: 기능 추가 요청]을 참고해서
UC7 알림 배지 기능을 추가해줘.

요청: 헤더 우측 상단에 읽지 않은 알림 개수 배지 추가
조건:
- Material-UI Badge 컴포넌트 사용
- Backend API는 이미 구현됨 (GET /api/alert/?is_read=false)
- 벨 아이콘 클릭 시 드롭다운으로 최근 5개 알림 표시
```

---

### 템플릿 3: 성능 개선 요청

```markdown
## [성능] 제목을 한 줄로 요약

**우선순위**: P1 (높음)
**모듈**: UC2 (EMR)
**역할**: Doctor
**환경**: Backend (Django)

### 문제 상황
환자 목록 조회 API(`GET /api/emr/patients/`)가 5초 이상 소요됨

### 현재 성능
- 환자 수: 1000명
- 응답 시간: 5.2초 (목표: < 500ms)

### 원인 분석
- N+1 쿼리 문제: 각 환자마다 진료 기록을 별도 조회
- 페이지네이션 미적용
- 인덱스 없음 (patient_id, created_at)

### 개선 방안
1. `select_related()` 또는 `prefetch_related()` 사용
2. 페이지네이션 적용 (페이지당 20명)
3. MySQL 인덱스 추가:
   ```sql
   CREATE INDEX idx_patient_id ON emr_patient(patient_id);
   CREATE INDEX idx_created_at ON emr_patient(created_at);
   ```

### 기대 결과
- 응답 시간: < 500ms
- 페이지네이션으로 20명씩 조회
```

**Claude에게 요청 시**:
```
[04_수정_지침서.md]의 [템플릿 3: 성능 개선 요청]을 참고해서
UC2 환자 목록 조회 API 성능을 개선해줘.

문제: GET /api/emr/patients/ 응답 시간 5초 이상
원인: N+1 쿼리, 페이지네이션 미적용, 인덱스 없음
목표: 응답 시간 < 500ms, 페이지당 20명 조회
```

---

### 템플릿 4: UI/UX 개선 요청

```markdown
## [UI] 제목을 한 줄로 요약

**우선순위**: P3 (낮음)
**모듈**: UC1 (ACCT)
**역할**: 전체 (All)
**환경**: Frontend (React)

### 요청 내용
로그인 화면에 비밀번호 표시/숨김 토글 버튼 추가

### 상세 설명
- 현재: 비밀번호 입력 시 마스킹만 됨 (*****)
- 요구사항:
  1. 비밀번호 입력 필드 우측에 눈 아이콘 추가
  2. 클릭 시 비밀번호 표시/숨김 토글
  3. 기본값: 숨김 상태

### 참고 디자인
- Material-UI IconButton + Visibility/VisibilityOff 아이콘 사용
- 예시: https://mui.com/material-ui/react-text-field/#input-adornments

### 기대 결과
- 사용자가 비밀번호 입력 오류를 쉽게 확인 가능
```

**Claude에게 요청 시**:
```
[04_수정_지침서.md]의 [템플릿 4: UI/UX 개선 요청]을 참고해서
로그인 화면에 비밀번호 표시/숨김 토글 버튼을 추가해줘.

요청: 비밀번호 필드 우측에 눈 아이콘 추가
조건: Material-UI IconButton + Visibility 아이콘 사용
```

---

### 템플릿 5: 보안 취약점 수정 요청

```markdown
## [보안] 제목을 한 줄로 요약

**우선순위**: P0 (긴급)
**모듈**: UC1 (ACCT)
**역할**: 전체 (All)
**환경**: Backend (Django)

### 취약점 내용
JWT 토큰 만료 시간이 무제한으로 설정되어 있음

### 보안 위험
- 토큰 탈취 시 영구적으로 악용 가능
- 로그아웃 후에도 토큰 유효

### 현재 코드
```python
# settings.py
REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': [
        'rest_framework.authentication.TokenAuthentication',
    ],
}
```

### 수정 방안
1. JWT 토큰 만료 시간 30분으로 설정
2. Refresh Token 구현 (만료 시간 7일)
3. 로그아웃 시 토큰 블랙리스트 추가

### 참고 라이브러리
- `djangorestframework-simplejwt` 사용 권장

### 기대 결과
- Access Token 만료 시간: 30분
- Refresh Token 만료 시간: 7일
- 로그아웃 시 토큰 무효화
```

**Claude에게 요청 시**:
```
[04_수정_지침서.md]의 [템플릿 5: 보안 취약점 수정 요청]을 참고해서
UC1의 JWT 토큰 만료 시간을 30분으로 설정해줘.

문제: 현재 토큰 만료 시간 무제한
목표: Access Token 30분, Refresh Token 7일
라이브러리: djangorestframework-simplejwt 사용
```

---

## 🎯 효과적인 요청 작성 예시

### ❌ 나쁜 예

```
"환자 목록이 느려요. 빨리 해주세요."
```

**문제점**:
- 어떤 화면인지 불명확 (React? Django API?)
- 얼마나 느린지 수치 없음
- 재현 방법 없음
- 우선순위 없음

---

### ✅ 좋은 예

```
[04_수정_지침서.md]의 [템플릿 3: 성능 개선 요청]을 참고해서
UC2 환자 목록 조회 API 성능을 개선해줘.

**우선순위**: P1 (높음)
**모듈**: UC2 (EMR)
**환경**: Backend (Django)

**문제**:
- API: GET /api/emr/patients/
- 현재 응답 시간: 5.2초
- 목표 응답 시간: < 500ms
- 환자 수: 1000명

**원인 분석**:
- N+1 쿼리 발생 (각 환자마다 진료 기록 별도 조회)
- 페이지네이션 미적용
- 인덱스 없음

**요청 사항**:
1. select_related() 또는 prefetch_related() 적용
2. 페이지네이션 추가 (페이지당 20명)
3. patient_id, created_at 인덱스 추가
```

**장점**:
- 모듈, 우선순위 명확
- 수치 기반 목표 제시
- 원인 분석 포함
- 구체적인 해결 방안 제시

---

## 📝 수정 요청 시 체크리스트

요청 전 아래 항목을 확인하세요:

- [ ] **모듈 명시**: UC1~UC9 중 어떤 모듈인가?
- [ ] **역할 명시**: 어떤 역할에서 발생하는가? (Admin, Doctor, ...)
- [ ] **환경 명시**: Frontend (React/Flutter) vs Backend (Django)
- [ ] **우선순위 설정**: P0~P3 중 하나 선택
- [ ] **재현 방법 제공**: 단계별로 문제 재현 가능한가?
- [ ] **기대 결과 명시**: 어떻게 동작해야 하는가?
- [ ] **관련 파일 언급**: 어떤 파일을 수정해야 하는가? (선택 사항)

---

## 🔍 자주 묻는 질문 (FAQ)

### Q1. Claude가 수정한 내용을 어떻게 확인하나요?

**A**: Claude는 수정 후 다음 정보를 제공합니다:
- 수정된 파일 경로
- 변경 사항 요약
- 테스트 방법
- 추가로 확인해야 할 사항

예시:
```
✅ 수정 완료

**수정된 파일**:
- src/api/axios.js (Authorization 헤더 추가)
- acct/views.py (Token 인증 로직 수정)

**테스트 방법**:
1. 서버 재시작: python manage.py runserver
2. React 재시작: npm start
3. doctor1 / doctor123 으로 로그인 시도
4. 대시보드 정상 표시 확인

**추가 확인 사항**:
- 다른 역할(Admin, Patient)도 동일하게 테스트 필요
```

---

### Q2. 여러 개의 수정 사항을 한 번에 요청할 수 있나요?

**A**: 가능하지만, **관련 있는 항목만** 묶어서 요청하세요.

✅ **좋은 예**:
```
UC1의 로그인 관련 수정 3가지를 요청합니다:
1. JWT 토큰 만료 시간 30분으로 설정
2. 로그인 실패 시 에러 메시지 개선
3. 비밀번호 표시/숨김 토글 버튼 추가
```

❌ **나쁜 예**:
```
UC1 로그인, UC5 DICOM 업로드, UC7 알림 배지, Flutter 화면 디자인 수정 요청
```
→ 서로 관련 없는 항목은 **개별 요청**으로 분리하세요.

---

### Q3. 긴급한 버그는 어떻게 요청하나요?

**A**: 우선순위를 **P0 (긴급)**으로 설정하고, 제목에 **[긴급]** 표시를 추가하세요.

```
[긴급] [버그] Doctor 로그인 시 500 Internal Server Error 발생

**우선순위**: P0 (긴급)
**영향 범위**: 모든 Doctor 역할 사용자
**발생 시점**: 2025-12-19 14:30 이후

**문제**:
- Doctor 역할로 로그인 시 500 에러 발생
- 에러 로그: "NoneType object has no attribute 'role'"
- 서비스 중단 상태

**요청**:
즉시 원인 파악 및 수정 필요
```

---

### Q4. Claude가 이해하지 못한 경우 어떻게 하나요?

**A**: 다음 정보를 **추가**로 제공하세요:
1. 스크린샷 또는 에러 로그 전문
2. 관련 파일의 현재 코드
3. 단계별 재현 방법 (더 자세히)

예시:
```
Claude, 내 요청을 다시 설명할게.

**현재 상황**:
- 파일: acct/views.py 의 login() 함수
- 코드:
  ```python
  def login(request):
      user = authenticate(username=..., password=...)
      # 여기서 에러 발생
  ```
- 에러: "NoneType object has no attribute 'role'"

**원인 추정**:
- authenticate()가 None을 반환하는 경우를 처리하지 않음

**요청**:
- authenticate() 실패 시 에러 메시지 반환하도록 수정
```

---

### Q5. 수정 후 테스트는 누가 하나요?

**A**: **사용자가 직접** 테스트해야 합니다.

Claude가 제공하는 **테스트 체크리스트**를 참고하세요:
- [ ] 수정된 기능 정상 동작 확인
- [ ] 다른 기능에 영향 없는지 확인 (Regression Test)
- [ ] 보안 취약점 없는지 확인
- [ ] 성능 목표 달성 확인 (해당 시)

---

## 📚 참고 자료

### 관련 문서
- [README.md](README.md) - 프로젝트 개요
- [CLAUDE_CONTEXT.md](CLAUDE_CONTEXT.md) - 시스템 아키텍처
- [03_개발_작업_순서.md](03_개발_작업_순서.md) - 1달 작업 순서
- [업무계획서.md](업무계획서.md) - 기술 스택별 업무 분류

### 외부 문서
- [Django REST Framework](https://www.django-rest-framework.org/)
- [Material-UI Components](https://mui.com/material-ui/getting-started/overview/)
- [React Router](https://reactrouter.com/)

---

## 💡 수정 요청 베스트 프랙티스

### 1. 한 번에 하나씩
- 한 요청에 **하나의 주제**만 다루기
- 여러 수정 사항은 별도 요청으로 분리

### 2. 구체적으로
- "빨리 해주세요" ❌
- "응답 시간 5초 → 500ms로 개선" ✅

### 3. 컨텍스트 제공
- 어떤 모듈, 어떤 역할, 어떤 환경인지 명시
- 재현 방법 제공

### 4. 기대 결과 명시
- "수정해주세요" ❌
- "로그인 성공 후 /dashboard로 리다이렉트" ✅

### 5. 우선순위 설정
- P0: 긴급 (시스템 중단, 보안 취약점)
- P1: 높음 (핵심 기능 버그)
- P2: 중간 (부가 기능, 개선 사항)
- P3: 낮음 (UI 개선, 코드 정리)

---

**Last Updated**: 2025-12-19
**Version**: 1.0
**Author**: Claude AI
